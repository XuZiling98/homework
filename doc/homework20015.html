<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="20015" />

<meta name="date" content="2020-12-15" />

<title>homework of StatComp20015</title>

<script>// Hide empty <a> tag within highlighted CodeBlock for screen reader accessibility (see https://github.com/jgm/pandoc/issues/6352#issuecomment-626106786) -->
// v0.0.1
// Written by JooYoung Seo (jooyoung@psu.edu) and Atsushi Yasumoto on June 1st, 2020.

document.addEventListener('DOMContentLoaded', function() {
  const codeList = document.getElementsByClassName("sourceCode");
  for (var i = 0; i < codeList.length; i++) {
    var linkList = codeList[i].getElementsByTagName('a');
    for (var j = 0; j < linkList.length; j++) {
      if (linkList[j].innerHTML === "") {
        linkList[j].setAttribute('aria-hidden', 'true');
      }
    }
  }
});
</script>


<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
code.sourceCode > span { display: inline-block; line-height: 1.25; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">homework of StatComp20015</h1>
<h4 class="author">20015</h4>
<h4 class="date">2020-12-15</h4>



<div id="section" class="section level1">
<h1>2020-09-22</h1>
<div id="question" class="section level2">
<h2>Question</h2>
<p>Use knitr to produce 3 examples in the book. The 1st example should contain texts and at least one figure. The 2nd example should contains texts and at least one table. The 3rd example should contain at least a couple of LaTeX formulas.</p>
</div>
<div id="answer" class="section level2">
<h2>Answer</h2>
<div id="example1" class="section level4">
<h4>Example1:</h4>
<p>Here are the height and weight data of 15 women, fit the function relationship between height and weight, and draw an image to observe the relationship between height and weight.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>wcoef=<span class="kw">lm</span>(women)<span class="op">$</span>coef</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw">plot</span>(women,<span class="dt">main=</span><span class="st">&#39;height-weight&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="example2" class="section level4">
<h4>Example2:</h4>
<p>A table formed by the first 10 data of iris.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>ir=<span class="kw">data.frame</span>(iris[<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>,])</span>
<span id="cb2-2"><a href="#cb2-2"></a>knitr<span class="op">::</span><span class="kw">kable</span>(ir)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="right">Sepal.Length</th>
<th align="right">Sepal.Width</th>
<th align="right">Petal.Length</th>
<th align="right">Petal.Width</th>
<th align="left">Species</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">5.1</td>
<td align="right">3.5</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.0</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.7</td>
<td align="right">3.2</td>
<td align="right">1.3</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.6</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">5.0</td>
<td align="right">3.6</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.4</td>
<td align="right">3.9</td>
<td align="right">1.7</td>
<td align="right">0.4</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.6</td>
<td align="right">3.4</td>
<td align="right">1.4</td>
<td align="right">0.3</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">5.0</td>
<td align="right">3.4</td>
<td align="right">1.5</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="odd">
<td align="right">4.4</td>
<td align="right">2.9</td>
<td align="right">1.4</td>
<td align="right">0.2</td>
<td align="left">setosa</td>
</tr>
<tr class="even">
<td align="right">4.9</td>
<td align="right">3.1</td>
<td align="right">1.5</td>
<td align="right">0.1</td>
<td align="left">setosa</td>
</tr>
</tbody>
</table>
</div>
<div id="example3" class="section level4">
<h4>Example3:</h4>
<p>If a random variable <span class="math inline">\(X\)</span> obeys a probability distribution with a position parameter <span class="math inline">\(\mu\)</span> and a scale parameter <span class="math inline">\(\sigma\)</span>, and its probability density function is</p>
<p><span class="math display">\[f(x)=\frac{1}{\sqrt{2\pi}\sigma}\exp(-\frac{(x-\mu)^{2}}{2\sigma^2})\]</span> If <span class="math inline">\(X\)</span> obeys the exponential distribution with parameter <span class="math inline">\(\lambda\)</span>, the probability density function of <span class="math inline">\(X\)</span> is</p>
<p><span class="math display">\[f(x)=\lambda e^{-\lambda x},x&gt;0\]</span></p>
</div>
</div>
</div>
<div id="section-1" class="section level1">
<h1>2020-09-29</h1>
<div id="question-1" class="section level2">
<h2>Question 1</h2>
<p>3.3 The Pareto<span class="math inline">\((a,b)\)</span> distribution has cdf</p>
<p><span class="math display">\[F(x)=1-\left(\frac{b}{x}\right)^{a},\quad x \ge b&gt;0,a&gt;0\]</span> Derive the probability inverse transformation <span class="math inline">\(F^{-1}(U)\)</span> and use the inverse transform method to simulate a random sample from the Pareto(2,2) distribution. Graph the density histogram of the sample with the Pareto(2,2) density superimposed for comparison.</p>
</div>
<div id="answer-1" class="section level2">
<h2>Answer 1</h2>
<p><span class="math inline">\(\because a=2,b=2\)</span> <span class="math inline">\(\therefore F^{-1}(y)=\frac{2}{(1-y)^{1/2}},\quad x \ge 2,\)</span> and <span class="math inline">\(f(x)=8x^{-3}\)</span>.</p>
<p>n=10000, generate the random observations from <span class="math inline">\(U(0,1)\)</span>(called ‘U’), you can get sample from <span class="math inline">\(F^{-1}(y)\)</span> (called ‘da’). Then graph the density histogram of the sample and curve the probability density curve.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>g=<span class="cf">function</span>(y) <span class="dv">2</span><span class="op">/</span>((<span class="dv">1</span><span class="op">-</span>y)<span class="op">^</span>(<span class="dv">1</span><span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb3-2"><a href="#cb3-2"></a>n=<span class="fl">1e4</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb3-4"><a href="#cb3-4"></a>U=<span class="kw">runif</span>(n)</span>
<span id="cb3-5"><a href="#cb3-5"></a>da=<span class="kw">g</span>(U)</span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="kw">hist</span>(da,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">100</span>,<span class="fl">0.5</span>),<span class="dt">freq=</span>F)</span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="kw">curve</span>(<span class="dv">8</span><span class="op">*</span>x<span class="op">^</span>(<span class="op">-</span><span class="dv">3</span>),<span class="dt">add=</span>T,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-2" class="section level2">
<h2>Question 2</h2>
<p>3.9 The rescaled Epanechnikov kernel [85] is a symmetric density function <span class="math display">\[f_{e}(x)=\frac{3}{4}(1-x^{2}),\quad |x|\le1.\]</span> Devroye and Gy<span class="math inline">\(\ddot{o}\)</span>rfi [71,p.236] give the following algorithm for simulation from this distribution. Generate iid <span class="math inline">\(U_{1},U_{2},U_{3} \sim\)</span>Uniform(-1,1). If <span class="math inline">\(|U_{3}|\ge|U_{2}|\)</span> and <span class="math inline">\(|U_{3}|\ge|U_{1}|\)</span>,deliver <span class="math inline">\(U_{2}\)</span>;otherwise deliver <span class="math inline">\(U_{3}\)</span>. Write a function to generate random variates from <span class="math inline">\(f_{e}\)</span>,and construct the histogram density estimate of a large simulated random sample.</p>
</div>
<div id="answer-2" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>n=<span class="fl">1e4</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw">set.seed</span>(<span class="dv">2345</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a>U=<span class="kw">matrix</span>(<span class="kw">runif</span>(<span class="dv">3</span><span class="op">*</span>n,<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>),<span class="dt">ncol=</span><span class="dv">3</span>)</span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="kw">colnames</span>(U)=<span class="kw">c</span>(<span class="st">&#39;U1&#39;</span>,<span class="st">&#39;U2&#39;</span>,<span class="st">&#39;U3&#39;</span>)</span>
<span id="cb4-5"><a href="#cb4-5"></a>da=<span class="kw">numeric</span>()</span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n){</span>
<span id="cb4-7"><a href="#cb4-7"></a>  <span class="cf">if</span>(<span class="kw">abs</span>(U[i,<span class="dv">3</span>])<span class="op">&gt;=</span><span class="kw">abs</span>(U[i,<span class="dv">2</span>]) <span class="op">&amp;</span><span class="st"> </span><span class="kw">abs</span>(U[i,<span class="dv">3</span>])<span class="op">&gt;=</span><span class="kw">abs</span>(U[i,<span class="dv">1</span>])) da[i]=U[i,<span class="dv">2</span>] <span class="cf">else</span></span>
<span id="cb4-8"><a href="#cb4-8"></a>    da[i]=U[i,<span class="dv">3</span>]</span>
<span id="cb4-9"><a href="#cb4-9"></a>}</span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="kw">hist</span>(da,<span class="dt">breaks =</span> <span class="kw">seq</span>(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,<span class="fl">0.05</span>),<span class="dt">freq=</span>F)</span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="kw">curve</span>(<span class="dv">3</span><span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>x<span class="op">^</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">4</span>,<span class="dt">add=</span>T,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3" class="section level2">
<h2>Question 3</h2>
<p>3.10 Prove that the algorithm given in Exercise 3.9 generates variates from the density <span class="math inline">\(f_{e}\)</span> (3.10).</p>
</div>
<div id="answer-3" class="section level2">
<h2>Answer 3</h2>
<p>suppose A:<span class="math inline">\(\max\{|U_{1}|,|U_{2}|,|U_{3}|\}=|U_{3}|\)</span>,B:<span class="math inline">\(\max\{|U_{1}|,|U_{2}|,|U_{3}|\}=|U_{2}|\)</span>,C:<span class="math inline">\(\max\{|U_{1}|,|U_{2}|,|U_{3}|\}=|U_{1}|\)</span>.</p>
<p><span class="math inline">\(\because P(|U_{i}|\le x)=P(-x\le U_{i}\le x)=x,\therefore |U_{i}|\sim U(0,1)\)</span>.</p>
<p>$P(|U_{3}|x,|U_{3}||U_{1}|)= $</p>
<p><span class="math inline">\(\because U_{i}\sim U(-1,1),\therefore P(U_{i}=x)=\frac{1}{2},x \in (-1,1)\)</span></p>
<p>therefore</p>
<p><span class="math display">\[
\begin{aligned}
P(U=x) &amp;= P(U_{2}=x,A)+P(U_{3}=x,B)+P(U_{3}=x,C)  \\
&amp;= P(A|U_{2}=x)P(U_{2}=x)+P(B|U_{3}=x)P(U_{3}=x)+P(C|U_{3}=x)P(U_{3}=x) \\
&amp;= 3 P(A|U_{2}=x)P(U_{2}=x) \\
&amp;= \frac{3}{2}P(A|U_{2}=x) \\
&amp;= \frac{3}{2}P(|U_{3}|\ge|x|,|U_{3}|\ge|U_{1}|)  \\
&amp;= \frac{3}{2}\frac{1+|x|}{2}(1-|x|) \\
&amp;= \frac{3}{4}(1-x^{2})=f_{e}(x)
\end{aligned}
\]</span></p>
</div>
<div id="question-4" class="section level2">
<h2>Question 4</h2>
<p>3.13 It can be shown that the mixture in Exercise 3.12 has a Pareto distribution with cdf <span class="math display">\[F(y)=1-\left(\frac{\beta}{\beta+y} \right)^{r},\quad y\ge0.\]</span> (This is an alternative parameterization of the Pareto cdf given in Exercise 3.3.) Generate 100 random observations from the mixture with <span class="math inline">\(r=4\)</span> and <span class="math inline">\(\beta =2\)</span>. Compare the empirical and theoretical(Pareto) distributions by graphing the density histogram of the sample and superimposing the Pareto density curve.</p>
</div>
<div id="answer-4" class="section level2">
<h2>Answer 4</h2>
<p><span class="math inline">\(\because r=4,\beta=2\)</span></p>
<p><span class="math inline">\(\therefore F(y)=1-\left(\frac{2}{2+y} \right)^{4}=1-16(2+y)^{-4},\quad y\ge0.\)</span></p>
<p><span class="math inline">\(\therefore f(y)=F&#39;(y)=64(2+y)^{-5}\)</span></p>
<p>First,n=1000,generate n random observations from Gamma(<span class="math inline">\(r,\beta\)</span>) distribution(called ‘a1’), for each random observations <span class="math inline">\(\lambda\)</span>, generate random observations from Exp(<span class="math inline">\(\lambda\)</span>) distribution(called ‘a2’). Then graph the density histogram of the sample and curve the Pareto density curve. we can see that the curve fits well.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>n=<span class="fl">1e3</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>a1=<span class="kw">rgamma</span>(n,<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb5-3"><a href="#cb5-3"></a>a2=<span class="kw">rexp</span>(n,a1)</span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="kw">hist</span>(a2,<span class="dt">breaks=</span><span class="kw">seq</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="fl">0.5</span>),<span class="dt">freq =</span> F)</span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="kw">curve</span>(<span class="dv">64</span><span class="op">*</span>(<span class="dv">2</span><span class="op">+</span>x)<span class="op">^</span>(<span class="op">-</span><span class="dv">5</span>),<span class="dt">add =</span> T,<span class="dt">col=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="section-2" class="section level1">
<h1>2020-10-13</h1>
<div id="question-1-1" class="section level2">
<h2>Question 1</h2>
<p>5.1 Compute a Monte Carlo estimate of <span class="math display">\[\int_{0}^{\pi/3}\sin t dt\]</span> and compare your estimate with the exact value of the integral.</p>
</div>
<div id="answer-1-1" class="section level2">
<h2>Answer 1</h2>
<p><span class="math inline">\(\because \int_{0}^{\pi/3}\sin t dt=\int_{0}^{\pi/3}\frac{\pi}{3}\sin t \frac{3}{\pi} dt\)</span></p>
<p>let <span class="math inline">\(g(t)=\frac{\pi}{3}\sin t,X\sim U(0,\frac{\pi}{3})\)</span></p>
<p><span class="math inline">\(\therefore \int_{0}^{\pi/3}\sin t dt=\int_{0}^{\pi/3} \frac{3}{\pi} g(t)dt=E[g(X)]\)</span></p>
<p>The Monte Carlo estimate is</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw">set.seed</span>(<span class="dv">3456</span>)</span>
<span id="cb6-2"><a href="#cb6-2"></a>n &lt;-<span class="st"> </span><span class="fl">1e4</span>                     </span>
<span id="cb6-3"><a href="#cb6-3"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="dv">0</span>,pi<span class="op">/</span><span class="dv">3</span>)  </span>
<span id="cb6-4"><a href="#cb6-4"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">sin</span>(x)<span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">g</span>(x))       <span class="co">#the Monte Carlo estimate</span></span>
<span id="cb6-6"><a href="#cb6-6"></a>theta &lt;-<span class="st"> </span><span class="kw">cos</span>(<span class="dv">0</span>)<span class="op">-</span><span class="kw">cos</span>(pi<span class="op">/</span><span class="dv">3</span>)    <span class="co">#the exact value of the integral</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="kw">print</span>(<span class="kw">c</span>(theta.hat,theta))</span></code></pre></div>
<pre><code>## [1] 0.5054554 0.5000000</code></pre>
</div>
<div id="question-2-1" class="section level2">
<h2>Question 2</h2>
<p>5.7 Refer to Exercise 5.6. Use a Monte Carlo simulation to estimate <span class="math inline">\(\theta\)</span> by the antithetic variate approach and by the simple Monte Carlo method. Compute an empirical estimate of the percent reduction in variance using the antithetic variate. Compare the result with the theoretical value from Exercise 5.6.</p>
</div>
<div id="answer-2-1" class="section level2">
<h2>Answer 2</h2>
<p><span class="math inline">\(\theta=E[e^{U}]=\int_{0}^{1}e^{u}du ,U\sim U(0,1)\)</span></p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">set.seed</span>(<span class="dv">3456</span>)</span>
<span id="cb8-2"><a href="#cb8-2"></a>n &lt;-<span class="st"> </span><span class="fl">1e4</span>                   </span>
<span id="cb8-3"><a href="#cb8-3"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)  </span>
<span id="cb8-4"><a href="#cb8-4"></a>theta_<span class="dv">1</span> &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">exp</span>(x))                    <span class="co">#theta_1: by the simple Monte Carlo estimate</span></span>
<span id="cb8-5"><a href="#cb8-5"></a>m &lt;-<span class="st"> </span><span class="fl">5e3</span></span>
<span id="cb8-6"><a href="#cb8-6"></a>y &lt;-<span class="st"> </span><span class="kw">runif</span>(m,<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb8-7"><a href="#cb8-7"></a>theta_<span class="dv">2</span> &lt;-<span class="st"> </span><span class="kw">mean</span>((<span class="kw">exp</span>(y)<span class="op">+</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>y))<span class="op">/</span><span class="dv">2</span>)       <span class="co">#theta_2: by the antithetic variate approach</span></span>
<span id="cb8-8"><a href="#cb8-8"></a>theta &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="dv">1</span>)<span class="op">-</span><span class="dv">1</span>                          <span class="co">#theta: the exact value of the integral</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>th &lt;-<span class="st"> </span><span class="kw">c</span>(theta_<span class="dv">1</span>,theta_<span class="dv">2</span>,theta)</span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="kw">names</span>(th) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;theta_1.&#39;</span>,<span class="st">&#39;theta_2.&#39;</span>,<span class="st">&#39;theta.&#39;</span>)</span>
<span id="cb8-11"><a href="#cb8-11"></a><span class="kw">print</span>(th)</span></code></pre></div>
<pre><code>## theta_1. theta_2.   theta. 
## 1.727533 1.718328 1.718282</code></pre>
<p>Let <span class="math inline">\(\hat{\theta}_{c}\)</span> be the estimator achieved by using antithetic variates approach. For <span class="math inline">\(m\)</span> replicates, <span class="math inline">\(var(\hat{\theta}_{c})\)</span> is</p>
<p><span class="math display">\[
\begin{aligned}
var(\hat{\theta}_{c}) &amp;= \frac{1}{m}var(\frac{e^{U}-e^{(1-U)}}{2}) \\
&amp;= \frac{1}{4m}(var(e^{U})+var(e^{1-U})+2cov(e^{U},e^{1-U})) \\
&amp;= \frac{1}{4m}(e^2+2e-1-4(e-1)^2) \\
&amp;= \frac{0.01564999}{4m}  \\
&amp;= \frac{1}{m}0.003912497
\end{aligned}
\]</span></p>
<p>Let <span class="math inline">\(\hat{\theta}\)</span> be the estimator achieved by using simple MC. For <span class="math inline">\(m\)</span> replicates, <span class="math inline">\(var(\hat{\theta})\)</span> is</p>
<p><span class="math display">\[
\begin{aligned}
var(\hat{\theta}) &amp;= \frac{1}{m}var(e^{U}) \\
&amp;= \frac{1}{m}(\frac{e^2-1}{2}-(e-1)^2) \\
&amp;= \frac{1}{m}0.2420351
\end{aligned}
\]</span> The result with the theoretical value from Exercise 5.6 is <span class="math inline">\(1-\frac{var(\hat{\theta}_{c})}{var(\hat{\theta})}=1-\frac{0.003912497}{0.2420351}=0.983835\)</span> .</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">set.seed</span>(<span class="dv">3456</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a>n &lt;-<span class="st"> </span><span class="fl">1e4</span>                   </span>
<span id="cb10-3"><a href="#cb10-3"></a>x &lt;-<span class="st"> </span><span class="kw">runif</span>(n,<span class="dv">0</span>,<span class="dv">1</span>)  </span>
<span id="cb10-4"><a href="#cb10-4"></a>var_theta_c &lt;-<span class="st"> </span><span class="kw">var</span>((<span class="kw">exp</span>(x)<span class="op">+</span><span class="kw">exp</span>(<span class="dv">1</span><span class="op">-</span>x))<span class="op">/</span><span class="dv">2</span>) <span class="co">#the sample variance of the estimate achieved by using antithetic approach</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>var_theta &lt;-<span class="st"> </span><span class="kw">var</span>(<span class="kw">exp</span>(x))                <span class="co">#the sample variance of the estimate achieved by using simple MC</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>pr &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.983835</span>,<span class="dv">1</span><span class="op">-</span>var_theta_c<span class="op">/</span>var_theta)     <span class="co">#pr: the percent reduction and an empirical estimate of the percent reduction</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="kw">names</span>(pr)=<span class="kw">c</span>(<span class="st">&#39;the result from Exercise5.6.&#39;</span>,<span class="st">&#39;empirical estimate.&#39;</span>)</span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="kw">print</span>(pr)</span></code></pre></div>
<pre><code>## the result from Exercise5.6.          empirical estimate. 
##                    0.9838350                    0.9834817</code></pre>
<p>An empirical estimate of the percent reduction in variance using the antithetic variate is <span class="math inline">\(0.9834817\)</span> .</p>
</div>
<div id="question-3-1" class="section level2">
<h2>Question 3</h2>
<p>5.11 If <span class="math inline">\(\hat{\theta}_{1}\)</span> and <span class="math inline">\(\hat{\theta}_{2}\)</span> are unbiased estimators of <span class="math inline">\(\theta\)</span>,and <span class="math inline">\(\hat{\theta}_{1}\)</span> and <span class="math inline">\(\hat{\theta}_{2}\)</span> are antithetic,we derived that <span class="math inline">\(c^{*}=1/2\)</span> is the optimal constant that minimizes the variance of <span class="math inline">\(\hat{\theta}_{c}=c\hat{\theta}_{1}+(1-c)\hat{\theta}_{2}\)</span>. Derive <span class="math inline">\(c^{*}\)</span> for the general case. That is, if <span class="math inline">\(\hat{\theta}_{1}\)</span> and <span class="math inline">\(\hat{\theta}_{2}\)</span> are any two unbiased estimators of <span class="math inline">\(\theta\)</span>, find the value <span class="math inline">\(c^{*}\)</span> that minimizes the variance of the estimator <span class="math inline">\(\hat{\theta}_{c}=c\hat{\theta}_{1}+(1-c)\hat{\theta}_{2}\)</span> in question (5.11).(<span class="math inline">\(c^{*}\)</span> will be a function of the variances and the covariance of the estimators.)</p>
</div>
<div id="answer-3-1" class="section level2">
<h2>Answer 3</h2>
<p>for the general case,<span class="math inline">\(\hat{\theta}_{c}=c\hat{\theta}_{1}+(1-c)\hat{\theta}_{2}\)</span></p>
<p><span class="math display">\[
\begin{aligned}
&amp; var(\hat{\theta}_{c}) \\
=&amp; var(c\hat{\theta}_{1}+(1-c)\hat{\theta}_{2}) \\
=&amp; c^{2}var(\hat{\theta}_{1})+(1-c)^{2}var(\hat{\theta}_{2})+2c(1-c)cov(\hat{\theta}_{1},\hat{\theta}_{2}) \\
=&amp; (var(\hat{\theta}_{1})+var(\hat{\theta}_{2})-2cov(\hat{\theta}_{1},\hat{\theta}_{2}))c^{2}-(2var(\hat{\theta}_{2})-2cov(\hat{\theta}_{1},\hat{\theta}_{2}))c+var(\hat{\theta}_{2}) \\
=&amp; (var(\hat{\theta}_{1})+var(\hat{\theta}_{2})-2cov(\hat{\theta}_{1},\hat{\theta}_{2}))(c-\frac{var(\hat{\theta}_{2})-cov(\hat{\theta}_{1},\hat{\theta}_{2})}{var(\hat{\theta}_{1})+var(\hat{\theta}_{2})-2cov(\hat{\theta}_{1},\hat{\theta}_{2})})^{2}+ \\
&amp; var(\hat{\theta}_{2})-\frac{(var(\hat{\theta}_{2})-cov(\hat{\theta}_{1},\hat{\theta}_{2}))^{2}}{var(\hat{\theta}_{1})+var(\hat{\theta}_{2})-2cov(\hat{\theta}_{1},\hat{\theta}_{2})}
\end{aligned}
\]</span></p>
<p>clearly, when <span class="math inline">\(c=\frac{var(\hat{\theta}_{2})-cov(\hat{\theta}_{1},\hat{\theta}_{2})}{var(\hat{\theta}_{1})+var(\hat{\theta}_{2})-2cov(\hat{\theta}_{1},\hat{\theta}_{2})}\)</span>, the variance of the estimator has a minimum.</p>
<p><span class="math inline">\(\therefore c^*=\frac{var(\hat{\theta}_{2})-cov(\hat{\theta}_{1},\hat{\theta}_{2})}{var(\hat{\theta}_{1})+var(\hat{\theta}_{2})-2cov(\hat{\theta}_{1},\hat{\theta}_{2})}\)</span></p>
</div>
</div>
<div id="section-3" class="section level1">
<h1>2020-10-20</h1>
<div id="question-1-2" class="section level2">
<h2>Question 1</h2>
<p>5.13 Find two importance functions <span class="math inline">\(f_1\)</span> and <span class="math inline">\(f_2\)</span> that are supported on <span class="math inline">\((1,\infty)\)</span> and are ‘close’ to <span class="math display">\[g(x)=\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2},x&gt;1\]</span> Which of your two importance functions should produce the smaller variance in estimating <span class="math display">\[\int_{1}^{\infty}\frac{x^2}{\sqrt{2\pi}}e^{-x^2/2}dx\]</span> by importance sampling? Explain.</p>
</div>
<div id="answer-1-2" class="section level2">
<h2>Answer 1</h2>
<p>The candidates for the importance functions are:</p>
<p>1.Normal distribution density function with parameters 1.5 and 1: <span class="math inline">\(f_1(x)=\frac{1}{\sqrt{2\pi}}\exp(-\frac{(x-1.5)^2}{2})\)</span></p>
<p>2.Gamma distribution density function with parameters 4 and 2:<span class="math inline">\(\alpha=4,\beta=2,f_2(x)=dgamma(x,4,2)\)</span></p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>m=<span class="fl">1e4</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>theta_hat &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a>se &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">2</span>)</span>
<span id="cb12-4"><a href="#cb12-4"></a></span>
<span id="cb12-5"><a href="#cb12-5"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x) (x<span class="op">^</span><span class="dv">2</span><span class="op">*</span><span class="kw">exp</span>(<span class="op">-</span>x<span class="op">^</span><span class="dv">2</span><span class="op">/</span><span class="dv">2</span>)<span class="op">/</span><span class="kw">sqrt</span>(<span class="dv">2</span><span class="op">*</span>pi)) <span class="op">*</span><span class="st"> </span>(x<span class="op">&gt;=</span><span class="dv">1</span>)</span>
<span id="cb12-6"><a href="#cb12-6"></a>f1 &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">dnorm</span>(x,<span class="fl">1.5</span>,<span class="dv">1</span>)</span>
<span id="cb12-7"><a href="#cb12-7"></a>f2 &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">dgamma</span>(x,<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb12-8"><a href="#cb12-8"></a></span>
<span id="cb12-9"><a href="#cb12-9"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb12-10"><a href="#cb12-10"></a><span class="kw">curve</span>(<span class="kw">g</span>(x),<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>),<span class="dt">ylab =</span> <span class="st">&#39;y&#39;</span>)</span>
<span id="cb12-11"><a href="#cb12-11"></a><span class="kw">curve</span>(<span class="kw">f1</span>(x),<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>),<span class="dt">add =</span> T,<span class="dt">col =</span> <span class="dv">2</span>,<span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb12-12"><a href="#cb12-12"></a><span class="kw">curve</span>(<span class="kw">f2</span>(x),<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">5</span>),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.5</span>),<span class="dt">add =</span> T,<span class="dt">col =</span> <span class="dv">3</span>,<span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&#39;g(x)&#39;</span>,<span class="st">&#39;f1(x)&#39;</span>,<span class="st">&#39;f2(x)&#39;</span>),</span>
<span id="cb12-14"><a href="#cb12-14"></a>           <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">inset =</span> <span class="fl">0.02</span>, <span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw">set.seed</span>(<span class="dv">1234</span>)</span>
<span id="cb13-2"><a href="#cb13-2"></a></span>
<span id="cb13-3"><a href="#cb13-3"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(m,<span class="fl">1.5</span>,<span class="dv">1</span>)          <span class="co">#using f1</span></span>
<span id="cb13-4"><a href="#cb13-4"></a>fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">dnorm</span>(x,<span class="fl">1.5</span>,<span class="dv">1</span>)</span>
<span id="cb13-5"><a href="#cb13-5"></a>theta_hat[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb13-6"><a href="#cb13-6"></a>se[<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb13-7"><a href="#cb13-7"></a></span>
<span id="cb13-8"><a href="#cb13-8"></a>x &lt;-<span class="st"> </span><span class="kw">rgamma</span>(m,<span class="dv">4</span>,<span class="dv">2</span>)          <span class="co">#using f2</span></span>
<span id="cb13-9"><a href="#cb13-9"></a>fg &lt;-<span class="st"> </span><span class="kw">g</span>(x) <span class="op">/</span><span class="st"> </span><span class="kw">dgamma</span>(x,<span class="dv">4</span>,<span class="dv">2</span>)</span>
<span id="cb13-10"><a href="#cb13-10"></a>theta_hat[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb13-11"><a href="#cb13-11"></a>se[<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">sd</span>(fg)</span>
<span id="cb13-12"><a href="#cb13-12"></a></span>
<span id="cb13-13"><a href="#cb13-13"></a>k &lt;-<span class="st"> </span><span class="kw">rbind</span>(theta_hat,se)</span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="kw">colnames</span>(k) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;f1&#39;</span>,<span class="st">&#39;f2&#39;</span>)</span>
<span id="cb13-15"><a href="#cb13-15"></a></span>
<span id="cb13-16"><a href="#cb13-16"></a><span class="kw">print</span>(k)</span></code></pre></div>
<pre><code>##                  f1        f2
## theta_hat 0.4082362 0.3991982
## se        0.3010635 0.2532093</code></pre>
<p>because 0.3010635 &gt; 0.2532093, therefore, <span class="math inline">\(f_2(x)\)</span> produce the smaller variance in estimating.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">par</span>(<span class="dt">mfrow=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw">curve</span>(<span class="kw">g</span>(x)<span class="op">/</span><span class="kw">g</span>(x),<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ylab =</span> <span class="st">&#39;y&#39;</span>)</span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="kw">curve</span>(<span class="kw">g</span>(x)<span class="op">/</span><span class="kw">f1</span>(x),<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">add =</span> T,<span class="dt">col =</span> <span class="dv">2</span>,<span class="dt">lty =</span> <span class="dv">2</span>)</span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="kw">curve</span>(<span class="kw">g</span>(x)<span class="op">/</span><span class="kw">f2</span>(x),<span class="dt">xlim =</span> <span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>),<span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">add =</span> T,<span class="dt">col =</span> <span class="dv">3</span>,<span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="kw">legend</span>(<span class="st">&quot;topright&quot;</span>, <span class="dt">legend =</span> <span class="kw">c</span>(<span class="st">&#39;g(x)/g(x)&#39;</span>,<span class="st">&#39;g(x)/f1(x)&#39;</span>,<span class="st">&#39;g(x)/f2(x)&#39;</span>),</span>
<span id="cb15-6"><a href="#cb15-6"></a>           <span class="dt">lty =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">3</span>, <span class="dt">lwd =</span> <span class="dv">2</span>, <span class="dt">inset =</span> <span class="fl">0.02</span>, <span class="dt">col=</span><span class="dv">1</span><span class="op">:</span><span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>according to the picture,we can see that the curve of <span class="math inline">\(g(x)/f_2(x)\)</span> is flatter than the curve of <span class="math inline">\(g(x)/f_1(x)\)</span>, therefore, <span class="math inline">\(f_2(x)\)</span> is closer to <span class="math inline">\(g(x)\)</span> and the variance of using <span class="math inline">\(f_2(x)\)</span> is smaller.</p>
</div>
<div id="question-2-2" class="section level2">
<h2>Question 2</h2>
<p>5.15 Obtain the stratified importance sampling estimate in Example 5.13 and compare it with the result of Example 5.10.</p>
</div>
<div id="answer-2-2" class="section level2">
<h2>Answer 2</h2>
<p>The result of example 5.10:</p>
<p>The best result was obtained with importance function <span class="math inline">\(f_3(x)=e^{-x}/(1 − e^{-1}), 0&lt;x&lt;1\)</span> with the estimate <span class="math inline">\(\hat{\theta}^{I} = 0.5257801\)</span> and an estimated standard error <span class="math inline">\(se^{I} = 0.0970314\)</span>.</p>
<p>The stratified importance sampling estimate in Example 5.13:</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a>m &lt;-<span class="st"> </span><span class="fl">1e4</span>       <span class="co"># sample size in each sub-interval</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>k &lt;-<span class="st"> </span><span class="dv">5</span>         <span class="co"># number of the sub-intervals</span></span>
<span id="cb16-3"><a href="#cb16-3"></a>g &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">+</span>x<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb16-4"><a href="#cb16-4"></a>f &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">exp</span>(<span class="op">-</span>x)<span class="op">/</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>))   <span class="co">#importance function</span></span>
<span id="cb16-5"><a href="#cb16-5"></a>theta.hat &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb16-6"><a href="#cb16-6"></a>sigma2.hat &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="dv">5</span>)</span>
<span id="cb16-7"><a href="#cb16-7"></a></span>
<span id="cb16-8"><a href="#cb16-8"></a><span class="kw">set.seed</span>(<span class="dv">4567</span>)</span>
<span id="cb16-9"><a href="#cb16-9"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">0</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb16-10"><a href="#cb16-10"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(m) </span>
<span id="cb16-11"><a href="#cb16-11"></a>  x &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">log</span>(<span class="dv">1</span><span class="op">-</span>u<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb16-12"><a href="#cb16-12"></a>  fg &lt;-<span class="st"> </span>(<span class="kw">g</span>(x) <span class="op">*</span><span class="st"> </span>(x<span class="op">&gt;</span>j<span class="op">/</span>k) <span class="op">*</span><span class="st"> </span>(x<span class="op">&lt;</span>(j<span class="op">+</span><span class="dv">1</span>)<span class="op">/</span>k)) <span class="op">/</span><span class="st"> </span>(<span class="kw">exp</span>(<span class="op">-</span>x) <span class="op">/</span><span class="st"> </span>(<span class="dv">1</span><span class="op">-</span><span class="kw">exp</span>(<span class="op">-</span><span class="dv">1</span>)))</span>
<span id="cb16-13"><a href="#cb16-13"></a>  theta.hat[j<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">mean</span>(fg)</span>
<span id="cb16-14"><a href="#cb16-14"></a>  sigma2.hat[j<span class="op">+</span><span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">var</span>(fg)</span>
<span id="cb16-15"><a href="#cb16-15"></a>}</span>
<span id="cb16-16"><a href="#cb16-16"></a>theta &lt;-<span class="st"> </span><span class="kw">sum</span>(theta.hat)</span>
<span id="cb16-17"><a href="#cb16-17"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(<span class="kw">sum</span>(sigma2.hat)<span class="op">/</span>m)</span>
<span id="cb16-18"><a href="#cb16-18"></a></span>
<span id="cb16-19"><a href="#cb16-19"></a>pa &lt;-<span class="st"> </span><span class="kw">c</span>(theta,se)</span>
<span id="cb16-20"><a href="#cb16-20"></a><span class="kw">names</span>(pa) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;theta_SI&#39;</span>,<span class="st">&#39;se_SI&#39;</span>)</span>
<span id="cb16-21"><a href="#cb16-21"></a></span>
<span id="cb16-22"><a href="#cb16-22"></a><span class="kw">print</span>(pa)</span></code></pre></div>
<pre><code>##    theta_SI       se_SI 
## 0.528442268 0.004681724</code></pre>
<p>therefore, <span class="math inline">\(\hat{\theta}^{SI} = 0.528442268\)</span> is similar to <span class="math inline">\(\hat{\theta}^{I}\)</span>,the estimated standard error <span class="math inline">\(se^{SI} = 0.004681724 &lt; se^{I}\)</span>. The stratified importance sampling estimate will provide smaller estimated standard error.</p>
</div>
<div id="question-3-2" class="section level2">
<h2>Question 3</h2>
<p>6.4 Suppose that <span class="math inline">\(X_1,...,X_n\)</span> are a random sample from a from a lognormal distribution with unknown parameters. Construct a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span>. Use a Monte Carlo method to obtain an empirical estimate of the confidence level.</p>
</div>
<div id="answer-3-2" class="section level2">
<h2>Answer 3</h2>
<p><span class="math inline">\(\because X_1,...,X_n\)</span> are a random sample from a from a lognormal distribution with unknown parameters,<span class="math inline">\(\therefore Y_1=\ln X_1,...,Y_n=\ln X_n \sim N(\mu,\sigma^2)\)</span>.</p>
<p><span class="math inline">\(EX=\exp(\mu + \frac{\sigma^2}{2})\)</span></p>
<p>a 95% confidence interval for the parameter <span class="math inline">\(\mu\)</span> is : <span class="math display">\[\frac{\sum_{i=1}^{n}\ln X_i}{n} \pm t_{n-1}(\alpha/2)\frac{S}{\sqrt{n}}, S^2=\frac{1}{n-1}\sum_{i=1}^{n}(\ln X_i-\frac{\sum_{i=1}^{n}\ln X_i}{n})^2\]</span></p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb18-2"><a href="#cb18-2"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb18-3"><a href="#cb18-3"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb18-4"><a href="#cb18-4"></a>mu &lt;-<span class="st"> </span><span class="dv">1</span>         <span class="co">#set logX~N(1,4) </span></span>
<span id="cb18-5"><a href="#cb18-5"></a>sigma &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb18-6"><a href="#cb18-6"></a></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="co">#general n random numbers from a lognormal distribution with unknown parameters </span></span>
<span id="cb18-8"><a href="#cb18-8"></a>U &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr =</span> {</span>
<span id="cb18-9"><a href="#cb18-9"></a>  y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n,<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb18-10"><a href="#cb18-10"></a>  x &lt;-<span class="st"> </span><span class="kw">exp</span>(y)</span>
<span id="cb18-11"><a href="#cb18-11"></a>  <span class="kw">c</span>(<span class="kw">mean</span>(y)<span class="op">-</span><span class="kw">sd</span>(y)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n),<span class="kw">mean</span>(y)<span class="op">+</span><span class="kw">sd</span>(y)<span class="op">*</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">/</span><span class="kw">sqrt</span>(n))</span>
<span id="cb18-12"><a href="#cb18-12"></a>} )</span>
<span id="cb18-13"><a href="#cb18-13"></a></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="kw">print</span>(<span class="kw">sum</span>(U[<span class="dv">1</span>,]<span class="op">&lt;</span><span class="dv">1</span> <span class="op">&amp;</span><span class="st"> </span>U[<span class="dv">2</span>,]<span class="op">&gt;</span><span class="dv">1</span>)<span class="op">/</span>m)   <span class="co">#empirical estimate of the confidence level.</span></span></code></pre></div>
<pre><code>## [1] 0.96</code></pre>
</div>
<div id="question-4-1" class="section level2">
<h2>Question 4</h2>
<p>6.5 Suppose a 95% symmetric t-interval is applied to estimate a mean, but the sample data are non-normal. Then the probability that the confidence interval covers the mean is not necessarily equal to 0.95. Use a Monte Carlo experiment to estimate the coverage probability of the t-interval for random samples of <span class="math inline">\(\chi^2(2)\)</span> data with sample size <span class="math inline">\(n = 20\)</span>. Compare your t-interval results with the simulation results in Example 6.4. (The t-interval should be more robust to departures from normality than the interval for variance.)</p>
</div>
<div id="answer-4-1" class="section level2">
<h2>Answer 4</h2>
<p><span class="math inline">\(\frac{\bar{X}-\mu}{S/\sqrt{n}} \sim t_{n-1}\)</span></p>
<p>95% symmetric t-interval is: <span class="math inline">\(\bar{X} \pm \frac{S\cdot t_{n-1}(\alpha/2)}{\sqrt{n}}\)</span></p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb20-2"><a href="#cb20-2"></a>m &lt;-<span class="st"> </span><span class="dv">1000</span></span>
<span id="cb20-3"><a href="#cb20-3"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="kw">set.seed</span>(<span class="dv">4553</span>)</span>
<span id="cb20-5"><a href="#cb20-5"></a>CL &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">1000</span>, <span class="dt">expr =</span> {</span>
<span id="cb20-6"><a href="#cb20-6"></a>  x &lt;-<span class="st"> </span><span class="kw">rchisq</span>(n,<span class="dv">2</span>)       <span class="co">#random samples of chisp^2 data</span></span>
<span id="cb20-7"><a href="#cb20-7"></a>  <span class="kw">c</span>(<span class="kw">mean</span>(x)<span class="op">-</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n),<span class="kw">mean</span>(x)<span class="op">+</span><span class="kw">qt</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">sd</span>(x)<span class="op">/</span><span class="kw">sqrt</span>(n))</span>
<span id="cb20-8"><a href="#cb20-8"></a>} )</span>
<span id="cb20-9"><a href="#cb20-9"></a></span>
<span id="cb20-10"><a href="#cb20-10"></a>cp &lt;-<span class="st"> </span><span class="kw">mean</span>(CL[<span class="dv">2</span>,]<span class="op">&gt;</span><span class="dv">2</span> <span class="op">&amp;</span><span class="st"> </span>CL[<span class="dv">1</span>,]<span class="op">&lt;</span><span class="dv">2</span>)   <span class="co">#coverage probability</span></span>
<span id="cb20-11"><a href="#cb20-11"></a><span class="kw">print</span>(cp)</span></code></pre></div>
<pre><code>## [1] 0.921</code></pre>
<p>comparing with the example 6.6, 0.921&gt;0.773 ,the t-interval is more robust to departures from normality than the interval for variance.</p>
</div>
</div>
<div id="section-4" class="section level1">
<h1>2020-10-27</h1>
<div id="question-1-3" class="section level2">
<h2>Question 1</h2>
<p>6.7 Estimate the power of the skewness test of normality against symmetric Beta<span class="math inline">\((\alpha,\alpha)\)</span> distributions and comment on the results. Are the results different for heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\nu)\)</span>?</p>
</div>
<div id="answer-1-3" class="section level2">
<h2>Answer 1</h2>
<p>Set confidence level is 0.05.</p>
<p>Let <span class="math inline">\(\alpha=2,3,4,6,10,20,30,40,50,60,70,80,90,100\)</span>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>skb &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb22-2"><a href="#cb22-2"></a>    <span class="co">#compute the sample coefficient of skewness</span></span>
<span id="cb22-3"><a href="#cb22-3"></a>  xbar &lt;-<span class="st"> </span><span class="kw">mean</span>(x)</span>
<span id="cb22-4"><a href="#cb22-4"></a>  b &lt;-<span class="st"> </span><span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">3</span>)<span class="op">/</span>(<span class="kw">mean</span>((x<span class="op">-</span>xbar)<span class="op">^</span><span class="dv">2</span>))<span class="op">^</span><span class="fl">1.5</span></span>
<span id="cb22-5"><a href="#cb22-5"></a>  <span class="kw">return</span>(b)</span>
<span id="cb22-6"><a href="#cb22-6"></a>}</span>
<span id="cb22-7"><a href="#cb22-7"></a></span>
<span id="cb22-8"><a href="#cb22-8"></a>alpha &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.1</span>,<span class="fl">0.2</span>,<span class="fl">0.5</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">6</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">30</span>,<span class="dv">40</span>,<span class="dv">50</span>,<span class="dv">60</span>,<span class="dv">70</span>,<span class="dv">80</span>,<span class="dv">90</span>,<span class="dv">100</span>)</span>
<span id="cb22-9"><a href="#cb22-9"></a>al &lt;-<span class="st"> </span><span class="fl">0.05</span>          <span class="co">#confidence level</span></span>
<span id="cb22-10"><a href="#cb22-10"></a>n &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb22-11"><a href="#cb22-11"></a>m &lt;-<span class="st"> </span><span class="fl">1e4</span></span>
<span id="cb22-12"><a href="#cb22-12"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(alpha)</span>
<span id="cb22-13"><a href="#cb22-13"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb22-14"><a href="#cb22-14"></a></span>
<span id="cb22-15"><a href="#cb22-15"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>al<span class="op">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>) <span class="op">/</span><span class="st"> </span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))  <span class="co">#critical value for the skewness test</span></span>
<span id="cb22-16"><a href="#cb22-16"></a></span>
<span id="cb22-17"><a href="#cb22-17"></a><span class="kw">set.seed</span>(<span class="dv">3444</span>)</span>
<span id="cb22-18"><a href="#cb22-18"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {    <span class="co">#for each alpha </span></span>
<span id="cb22-19"><a href="#cb22-19"></a>  a &lt;-<span class="st"> </span>alpha[j]</span>
<span id="cb22-20"><a href="#cb22-20"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb22-21"><a href="#cb22-21"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {   <span class="co">#for each replicate</span></span>
<span id="cb22-22"><a href="#cb22-22"></a>    x &lt;-<span class="st"> </span><span class="kw">rbeta</span>(n,a,a)</span>
<span id="cb22-23"><a href="#cb22-23"></a>    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">skb</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb22-24"><a href="#cb22-24"></a>  }</span>
<span id="cb22-25"><a href="#cb22-25"></a>  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb22-26"><a href="#cb22-26"></a>}</span>
<span id="cb22-27"><a href="#cb22-27"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pwr)<span class="op">/</span>m)      <span class="co">#standard errors</span></span>
<span id="cb22-28"><a href="#cb22-28"></a>p &lt;-<span class="st"> </span><span class="kw">cbind</span>(pwr,se)</span>
<span id="cb22-29"><a href="#cb22-29"></a><span class="kw">rownames</span>(p) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="kw">rep</span>(<span class="st">&#39;alpha=&#39;</span>,N),alpha,<span class="dt">sep =</span> <span class="st">&#39;&#39;</span>)</span>
<span id="cb22-30"><a href="#cb22-30"></a>knitr<span class="op">::</span><span class="kw">kable</span>(p)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">pwr</th>
<th align="right">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">alpha=0</td>
<td align="right">0.0428</td>
<td align="right">0.0020241</td>
</tr>
<tr class="even">
<td align="left">alpha=0.1</td>
<td align="right">0.0384</td>
<td align="right">0.0019216</td>
</tr>
<tr class="odd">
<td align="left">alpha=0.2</td>
<td align="right">0.0340</td>
<td align="right">0.0018123</td>
</tr>
<tr class="even">
<td align="left">alpha=0.5</td>
<td align="right">0.0141</td>
<td align="right">0.0011790</td>
</tr>
<tr class="odd">
<td align="left">alpha=2</td>
<td align="right">0.0103</td>
<td align="right">0.0010096</td>
</tr>
<tr class="even">
<td align="left">alpha=3</td>
<td align="right">0.0129</td>
<td align="right">0.0011284</td>
</tr>
<tr class="odd">
<td align="left">alpha=4</td>
<td align="right">0.0166</td>
<td align="right">0.0012777</td>
</tr>
<tr class="even">
<td align="left">alpha=6</td>
<td align="right">0.0221</td>
<td align="right">0.0014701</td>
</tr>
<tr class="odd">
<td align="left">alpha=10</td>
<td align="right">0.0355</td>
<td align="right">0.0018504</td>
</tr>
<tr class="even">
<td align="left">alpha=20</td>
<td align="right">0.0443</td>
<td align="right">0.0020576</td>
</tr>
<tr class="odd">
<td align="left">alpha=30</td>
<td align="right">0.0459</td>
<td align="right">0.0020927</td>
</tr>
<tr class="even">
<td align="left">alpha=40</td>
<td align="right">0.0465</td>
<td align="right">0.0021057</td>
</tr>
<tr class="odd">
<td align="left">alpha=50</td>
<td align="right">0.0488</td>
<td align="right">0.0021545</td>
</tr>
<tr class="even">
<td align="left">alpha=60</td>
<td align="right">0.0499</td>
<td align="right">0.0021774</td>
</tr>
<tr class="odd">
<td align="left">alpha=70</td>
<td align="right">0.0497</td>
<td align="right">0.0021732</td>
</tr>
<tr class="even">
<td align="left">alpha=80</td>
<td align="right">0.0517</td>
<td align="right">0.0022142</td>
</tr>
<tr class="odd">
<td align="left">alpha=90</td>
<td align="right">0.0510</td>
<td align="right">0.0022000</td>
</tr>
<tr class="even">
<td align="left">alpha=100</td>
<td align="right">0.0510</td>
<td align="right">0.0022000</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>    <span class="co">#plot power vs alpha</span></span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="kw">plot</span>(alpha, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="fl">0.06</span>))</span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.05</span>, <span class="dt">lty =</span> <span class="dv">5</span>, <span class="dt">col =</span> <span class="dv">2</span>)</span>
<span id="cb23-4"><a href="#cb23-4"></a><span class="kw">lines</span>(alpha, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="kw">lines</span>(alpha, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>It’s easy to see that , when <span class="math inline">\(\alpha\)</span> is large enough , the power is similarly to the confidence level.</p>
<p>For heavy-tailed symmetric alternatives such as <span class="math inline">\(t(\nu)\)</span>.Let <span class="math inline">\(\nu = 1,2,5,10,100,200,400\)</span></p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>nu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">5</span>,<span class="dv">10</span>,<span class="dv">100</span>,<span class="dv">200</span>,<span class="dv">400</span>)</span>
<span id="cb24-2"><a href="#cb24-2"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span>          <span class="co">#confidence level</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb24-4"><a href="#cb24-4"></a>m &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb24-5"><a href="#cb24-5"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(nu)</span>
<span id="cb24-6"><a href="#cb24-6"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb24-7"><a href="#cb24-7"></a></span>
<span id="cb24-8"><a href="#cb24-8"></a>cv &lt;-<span class="st"> </span><span class="kw">qnorm</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,<span class="dv">0</span>,<span class="kw">sqrt</span>(<span class="dv">6</span><span class="op">*</span>(n<span class="dv">-2</span>)<span class="op">/</span>((n<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(n<span class="op">+</span><span class="dv">3</span>))))  <span class="co">#critical value for the skewness test</span></span>
<span id="cb24-9"><a href="#cb24-9"></a></span>
<span id="cb24-10"><a href="#cb24-10"></a><span class="kw">set.seed</span>(<span class="dv">3444</span>)</span>
<span id="cb24-11"><a href="#cb24-11"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {    <span class="co">#for each alpha </span></span>
<span id="cb24-12"><a href="#cb24-12"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb24-13"><a href="#cb24-13"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m) {   <span class="co">#for each replicate</span></span>
<span id="cb24-14"><a href="#cb24-14"></a>    x &lt;-<span class="st"> </span><span class="kw">rt</span>(n,nu[j])</span>
<span id="cb24-15"><a href="#cb24-15"></a>    sktests[i] &lt;-<span class="st"> </span><span class="kw">as.integer</span>(<span class="kw">abs</span>(<span class="kw">skb</span>(x)) <span class="op">&gt;=</span><span class="st"> </span>cv)</span>
<span id="cb24-16"><a href="#cb24-16"></a>  }</span>
<span id="cb24-17"><a href="#cb24-17"></a>  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb24-18"><a href="#cb24-18"></a>}</span>
<span id="cb24-19"><a href="#cb24-19"></a>se &lt;-<span class="st"> </span><span class="kw">sqrt</span>(pwr<span class="op">*</span>(<span class="dv">1</span><span class="op">-</span>pwr)<span class="op">/</span>m)      <span class="co">#standard errors</span></span>
<span id="cb24-20"><a href="#cb24-20"></a>p &lt;-<span class="st"> </span><span class="kw">cbind</span>(pwr,se)</span>
<span id="cb24-21"><a href="#cb24-21"></a><span class="kw">rownames</span>(p) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="kw">rep</span>(<span class="st">&#39;nu=&#39;</span>,N),nu,<span class="dt">sep =</span> <span class="st">&#39;&#39;</span>)</span>
<span id="cb24-22"><a href="#cb24-22"></a>knitr<span class="op">::</span><span class="kw">kable</span>(p)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">pwr</th>
<th align="right">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">nu=1</td>
<td align="right">0.8380</td>
<td align="right">0.0082388</td>
</tr>
<tr class="even">
<td align="left">nu=2</td>
<td align="right">0.5965</td>
<td align="right">0.0109701</td>
</tr>
<tr class="odd">
<td align="left">nu=5</td>
<td align="right">0.2660</td>
<td align="right">0.0098804</td>
</tr>
<tr class="even">
<td align="left">nu=10</td>
<td align="right">0.1590</td>
<td align="right">0.0081768</td>
</tr>
<tr class="odd">
<td align="left">nu=100</td>
<td align="right">0.0660</td>
<td align="right">0.0055518</td>
</tr>
<tr class="even">
<td align="left">nu=200</td>
<td align="right">0.0470</td>
<td align="right">0.0047324</td>
</tr>
<tr class="odd">
<td align="left">nu=400</td>
<td align="right">0.0455</td>
<td align="right">0.0046599</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a>    <span class="co">#plot power vs alpha</span></span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="kw">plot</span>(nu, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>, <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.05</span>, <span class="dt">lty =</span> <span class="dv">5</span>, <span class="dt">col =</span> <span class="dv">2</span>)</span>
<span id="cb25-4"><a href="#cb25-4"></a><span class="kw">lines</span>(nu, pwr<span class="op">+</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span>
<span id="cb25-5"><a href="#cb25-5"></a><span class="kw">lines</span>(nu, pwr<span class="op">-</span>se, <span class="dt">lty =</span> <span class="dv">3</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Also easy to see that , when <span class="math inline">\(\nu \rightarrow \infty\)</span>, <span class="math inline">\(power \rightarrow 0.05\)</span>.</p>
</div>
<div id="question-2-3" class="section level2">
<h2>Question 2</h2>
<p>6.8 Refer to Example 6.16. Repeat the simulation, but also compute the F test of equal variance, at significance level <span class="math inline">\(\hat{\alpha} \doteq 0.055\)</span>. Compare the power of the Count Five test and F test for small, medium, and large sample sizes. (Recall that the F test is not applicable for non-normal distributions.)</p>
</div>
<div id="answer-2-3" class="section level2">
<h2>Answer 2</h2>
<p>sample size:<span class="math inline">\(n=(10,20,40)\)</span></p>
<p><span class="math inline">\(\hat{\alpha} \doteq 0.055\)</span></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a>c5t &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {     <span class="co">#count five test</span></span>
<span id="cb26-2"><a href="#cb26-2"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">&gt;</span><span class="kw">max</span>((y<span class="op">-</span><span class="kw">mean</span>(y))))<span class="op">+</span><span class="kw">sum</span>((x<span class="op">-</span><span class="kw">mean</span>(x))<span class="op">&lt;</span><span class="kw">min</span>((y<span class="op">-</span><span class="kw">mean</span>(y))))</span>
<span id="cb26-3"><a href="#cb26-3"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>((y<span class="op">-</span><span class="kw">mean</span>(y))<span class="op">&gt;</span><span class="kw">max</span>((x<span class="op">-</span><span class="kw">mean</span>(x))))<span class="op">+</span><span class="kw">sum</span>((y<span class="op">-</span><span class="kw">mean</span>(y))<span class="op">&lt;</span><span class="kw">min</span>((x<span class="op">-</span><span class="kw">mean</span>(x))))</span>
<span id="cb26-4"><a href="#cb26-4"></a>  <span class="co"># return 1 (reject) or 0 (do not reject H0)</span></span>
<span id="cb26-5"><a href="#cb26-5"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy))<span class="op">&gt;</span><span class="dv">5</span>))</span>
<span id="cb26-6"><a href="#cb26-6"></a>}</span>
<span id="cb26-7"><a href="#cb26-7"></a>ft &lt;-<span class="st"> </span><span class="cf">function</span>(x, y){    <span class="co">#F test of equal variance</span></span>
<span id="cb26-8"><a href="#cb26-8"></a>  f &lt;-<span class="st"> </span><span class="kw">var.test</span>(x,y)</span>
<span id="cb26-9"><a href="#cb26-9"></a>  <span class="kw">return</span>(<span class="kw">as.integer</span>(f<span class="op">$</span>p.value<span class="op">&lt;</span><span class="fl">0.05</span>))</span>
<span id="cb26-10"><a href="#cb26-10"></a>}</span>
<span id="cb26-11"><a href="#cb26-11"></a></span>
<span id="cb26-12"><a href="#cb26-12"></a>m &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb26-13"><a href="#cb26-13"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">40</span>,<span class="dv">100</span>)     <span class="co">#10, 20, 40 for small, medium, and large sample sizes</span></span>
<span id="cb26-14"><a href="#cb26-14"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(n)</span>
<span id="cb26-15"><a href="#cb26-15"></a>c5t.power &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb26-16"><a href="#cb26-16"></a>ft.power &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb26-17"><a href="#cb26-17"></a></span>
<span id="cb26-18"><a href="#cb26-18"></a><span class="co"># generate samples under H1 to estimate power</span></span>
<span id="cb26-19"><a href="#cb26-19"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb26-20"><a href="#cb26-20"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.5</span></span>
<span id="cb26-21"><a href="#cb26-21"></a><span class="kw">set.seed</span>(<span class="dv">2789</span>)</span>
<span id="cb26-22"><a href="#cb26-22"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb26-23"><a href="#cb26-23"></a>  k &lt;-<span class="st"> </span><span class="kw">replicate</span>(m, <span class="dt">expr=</span>{</span>
<span id="cb26-24"><a href="#cb26-24"></a>    x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, sigma1)</span>
<span id="cb26-25"><a href="#cb26-25"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">20</span>, <span class="dv">0</span>, sigma2)</span>
<span id="cb26-26"><a href="#cb26-26"></a>    <span class="kw">c</span>(<span class="kw">ft</span>(x, y),<span class="kw">c5t</span>(x,y))</span>
<span id="cb26-27"><a href="#cb26-27"></a>  })</span>
<span id="cb26-28"><a href="#cb26-28"></a>  ft.power[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(k[<span class="dv">1</span>,])</span>
<span id="cb26-29"><a href="#cb26-29"></a>  c5t.power[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(k[<span class="dv">2</span>,])</span>
<span id="cb26-30"><a href="#cb26-30"></a>}</span>
<span id="cb26-31"><a href="#cb26-31"></a></span>
<span id="cb26-32"><a href="#cb26-32"></a>p &lt;-<span class="st"> </span><span class="kw">cbind</span>(ft.power,c5t.power)</span>
<span id="cb26-33"><a href="#cb26-33"></a><span class="kw">rownames</span>(p) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="kw">rep</span>(<span class="st">&#39;n=&#39;</span>,<span class="dv">3</span>),n,<span class="dt">sep=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb26-34"><a href="#cb26-34"></a>knitr<span class="op">::</span><span class="kw">kable</span>(p)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">ft.power</th>
<th align="right">c5t.power</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">n=10</td>
<td align="right">0.4175</td>
<td align="right">0.3205</td>
</tr>
<tr class="even">
<td align="left">n=20</td>
<td align="right">0.4085</td>
<td align="right">0.3070</td>
</tr>
<tr class="odd">
<td align="left">n=40</td>
<td align="right">0.3910</td>
<td align="right">0.3055</td>
</tr>
<tr class="even">
<td align="left">n=100</td>
<td align="right">0.4025</td>
<td align="right">0.3135</td>
</tr>
</tbody>
</table>
<p>at significance level <span class="math inline">\(\hat{\alpha} \doteq 0.055\)</span>, the power of the F test is larger than the power of the Count Five test, and the power of the F test is closer to 0.05 .</p>
</div>
<div id="question-3-3" class="section level2">
<h2>Question 3</h2>
<p>6.C Repeat Examples 6.8 and 6.10 for Mardia’s multivariate skewness test. Mardia [187] proposed tests of multivariate normality based on multivariate generalizations of skewness and kurtosis. If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are iid, the multivariate population skewness <span class="math inline">\(\beta_{1,d}\)</span> is defined by Mardia as <span class="math display">\[\beta_{1,d}=E[(X-\mu)^T\Sigma^{-1}(Y-\mu)]^3\]</span> Under normality, <span class="math inline">\(\beta_{1,d}=0\)</span>. The multivariate skewness statistic is <span class="math display">\[b_{1,d}=\frac{1}{n^2}\sum_{i,j=1}^{n}((X_i-\bar{X})^T\hat{\Sigma}^{-1}(X_j-\bar{X}))^3\]</span> where <span class="math inline">\(\hat{\Sigma}\)</span> is the maximum likelihood estimator of covariance. Large values of <span class="math inline">\(b_{1,d}\)</span> are significant. The asymptotic distribution of <span class="math inline">\(nb_{1,d}/6\)</span> is chisquared with <span class="math inline">\(d(d + 1)(d + 2)/6\)</span> degrees of freedom.</p>
</div>
<div id="answer-3-3" class="section level2">
<h2>Answer 3</h2>
<p>it takes a long time to run the code.</p>
<p>like example 6.8:</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a>msk &lt;-<span class="st"> </span><span class="cf">function</span>(x) {    <span class="co">#computes the sample skewness coeff.</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>  hat.sigma &lt;-<span class="st"> </span><span class="kw">cov</span>(x)     <span class="co">#maximum likelihood estimator of covariance</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>  xbar &lt;-<span class="st"> </span><span class="kw">apply</span>(x,<span class="dv">2</span>,mean)  <span class="co">#Take the average of each column</span></span>
<span id="cb27-4"><a href="#cb27-4"></a>  n &lt;-<span class="st"> </span><span class="kw">nrow</span>(x)</span>
<span id="cb27-5"><a href="#cb27-5"></a>  b &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rep</span>(<span class="dv">0</span>,n<span class="op">*</span>n),<span class="dt">ncol =</span> n)</span>
<span id="cb27-6"><a href="#cb27-6"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb27-7"><a href="#cb27-7"></a>    <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb27-8"><a href="#cb27-8"></a>      b[i,j] &lt;-<span class="st"> </span>(<span class="kw">t</span>(<span class="kw">as.matrix</span>(x[i,]<span class="op">-</span>xbar)) <span class="op">%*%</span><span class="st"> </span><span class="kw">solve</span>(hat.sigma) <span class="op">%*%</span><span class="st"> </span><span class="kw">as.matrix</span>(x[j,]<span class="op">-</span>xbar))<span class="op">^</span><span class="dv">3</span></span>
<span id="cb27-9"><a href="#cb27-9"></a>    }</span>
<span id="cb27-10"><a href="#cb27-10"></a>  }</span>
<span id="cb27-11"><a href="#cb27-11"></a>  <span class="kw">return</span>(<span class="kw">mean</span>(b))</span>
<span id="cb27-12"><a href="#cb27-12"></a>}</span>
<span id="cb27-13"><a href="#cb27-13"></a></span>
<span id="cb27-14"><a href="#cb27-14"></a>n &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">30</span>,<span class="dv">50</span>)  </span>
<span id="cb27-15"><a href="#cb27-15"></a><span class="co">#lack of the result of n=500 and n=300 which takes too much time to run the code</span></span>
<span id="cb27-16"><a href="#cb27-16"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(n)</span>
<span id="cb27-17"><a href="#cb27-17"></a>d &lt;-<span class="st"> </span><span class="dv">2</span>   <span class="co">#The dimension</span></span>
<span id="cb27-18"><a href="#cb27-18"></a>cv &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="fl">0.95</span>,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)       <span class="co">#crit. values </span></span>
<span id="cb27-19"><a href="#cb27-19"></a><span class="co">#we are doing length(n) different simulations</span></span>
<span id="cb27-20"><a href="#cb27-20"></a>p.reject &lt;-<span class="st"> </span><span class="kw">numeric</span>(N) <span class="co">#to store sim. results</span></span>
<span id="cb27-21"><a href="#cb27-21"></a>m &lt;-<span class="st"> </span><span class="fl">3e3</span>     <span class="co">#num. repl. each sim.</span></span>
<span id="cb27-22"><a href="#cb27-22"></a></span>
<span id="cb27-23"><a href="#cb27-23"></a><span class="kw">library</span>(MASS)</span>
<span id="cb27-24"><a href="#cb27-24"></a>mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb27-25"><a href="#cb27-25"></a>Sigma &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="fl">0.1</span>,<span class="fl">0.1</span>,<span class="dv">1</span>),<span class="dt">nrow =</span> <span class="dv">2</span>)</span>
<span id="cb27-26"><a href="#cb27-26"></a></span>
<span id="cb27-27"><a href="#cb27-27"></a><span class="kw">set.seed</span>(<span class="dv">4563</span>)</span>
<span id="cb27-28"><a href="#cb27-28"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) {</span>
<span id="cb27-29"><a href="#cb27-29"></a>  sktests &lt;-<span class="st"> </span><span class="kw">replicate</span>(m,<span class="dt">expr =</span> {</span>
<span id="cb27-30"><a href="#cb27-30"></a>    x &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(n[i],mu,Sigma)</span>
<span id="cb27-31"><a href="#cb27-31"></a>    <span class="kw">as.integer</span>(n[i]<span class="op">*</span><span class="kw">msk</span>(x)<span class="op">/</span><span class="dv">6</span> <span class="op">&gt;=</span><span class="st"> </span>cv )</span>
<span id="cb27-32"><a href="#cb27-32"></a>  })</span>
<span id="cb27-33"><a href="#cb27-33"></a>  p.reject[i] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests) <span class="co">#proportion rejected</span></span>
<span id="cb27-34"><a href="#cb27-34"></a>}</span>
<span id="cb27-35"><a href="#cb27-35"></a></span>
<span id="cb27-36"><a href="#cb27-36"></a><span class="kw">names</span>(p.reject) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="kw">rep</span>(<span class="st">&#39;n=&#39;</span>,N),n,<span class="dt">sep=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb27-37"><a href="#cb27-37"></a>knitr<span class="op">::</span><span class="kw">kable</span>(<span class="kw">round</span>(p.reject,<span class="dv">5</span>))</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">n=10</td>
<td align="right">0.00000</td>
</tr>
<tr class="even">
<td align="left">n=30</td>
<td align="right">0.02533</td>
</tr>
<tr class="odd">
<td align="left">n=50</td>
<td align="right">0.03667</td>
</tr>
</tbody>
</table>
<p>when <span class="math inline">\(n\rightarrow \infty\)</span>, t1e rate is close to 0.05.</p>
<p>like example 6.10:</p>
<p>The contaminated normal distribution is denoted by <span class="math display">\[(1-\epsilon)N(\mu=(0,0)&#39;,\Sigma_1)+\epsilon N(\mu=(0,0)&#39;,\Sigma_2),0&lt;\epsilon&lt;1\]</span> where <span class="math display">\[
\Sigma_1=
\begin{pmatrix}
1 &amp; 0 \\
0 &amp; 1
\end{pmatrix}
,
\Sigma_2=
\begin{pmatrix}
100 &amp; 0 \\
0 &amp; 100
\end{pmatrix}
\]</span></p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>gen &lt;-<span class="st"> </span><span class="cf">function</span>(d,n,mu,sigma1,sigma2){</span>
<span id="cb28-2"><a href="#cb28-2"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span><span class="op">:</span>(d<span class="op">*</span>n),<span class="dt">ncol=</span>d)</span>
<span id="cb28-3"><a href="#cb28-3"></a>  sa &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="dt">replace =</span> <span class="ot">TRUE</span>,<span class="dt">size =</span> n, <span class="dt">prob =</span> <span class="kw">c</span>(<span class="dv">1</span><span class="op">-</span>e, e))</span>
<span id="cb28-4"><a href="#cb28-4"></a>  <span class="cf">for</span> (k <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb28-5"><a href="#cb28-5"></a>    <span class="cf">if</span>(sa[k]<span class="op">==</span><span class="dv">1</span>) sigma &lt;-<span class="st"> </span>sigma1 <span class="cf">else</span> sigma &lt;-<span class="st"> </span>sigma2</span>
<span id="cb28-6"><a href="#cb28-6"></a>    x[k,] &lt;-<span class="st"> </span><span class="kw">mvrnorm</span>(<span class="dv">1</span>,<span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>),sigma)</span>
<span id="cb28-7"><a href="#cb28-7"></a>  }</span>
<span id="cb28-8"><a href="#cb28-8"></a>  <span class="kw">return</span>(x)</span>
<span id="cb28-9"><a href="#cb28-9"></a>}</span>
<span id="cb28-10"><a href="#cb28-10"></a></span>
<span id="cb28-11"><a href="#cb28-11"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb28-12"><a href="#cb28-12"></a>n &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb28-13"><a href="#cb28-13"></a>d &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb28-14"><a href="#cb28-14"></a>m &lt;-<span class="st"> </span><span class="dv">100</span></span>
<span id="cb28-15"><a href="#cb28-15"></a>epsilon &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">seq</span>(<span class="dv">0</span>, <span class="fl">.15</span>, <span class="fl">.01</span>), <span class="kw">seq</span>(.<span class="dv">15</span>, <span class="dv">1</span>, <span class="fl">.05</span>))</span>
<span id="cb28-16"><a href="#cb28-16"></a>N &lt;-<span class="st"> </span><span class="kw">length</span>(epsilon)</span>
<span id="cb28-17"><a href="#cb28-17"></a>pwr &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb28-18"><a href="#cb28-18"></a><span class="co">#critical value for the skewness test</span></span>
<span id="cb28-19"><a href="#cb28-19"></a>cv1 &lt;-<span class="st"> </span><span class="kw">qchisq</span>(alpha<span class="op">/</span><span class="dv">2</span>,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb28-20"><a href="#cb28-20"></a>cv2 &lt;-<span class="st"> </span><span class="kw">qchisq</span>(<span class="dv">1</span><span class="op">-</span>alpha<span class="op">/</span><span class="dv">2</span>,d<span class="op">*</span>(d<span class="op">+</span><span class="dv">1</span>)<span class="op">*</span>(d<span class="op">+</span><span class="dv">2</span>)<span class="op">/</span><span class="dv">6</span>)</span>
<span id="cb28-21"><a href="#cb28-21"></a></span>
<span id="cb28-22"><a href="#cb28-22"></a>mu &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>)</span>
<span id="cb28-23"><a href="#cb28-23"></a>sigma1 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb28-24"><a href="#cb28-24"></a>sigma2 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">c</span>(<span class="dv">10</span>,<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">10</span>),<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb28-25"><a href="#cb28-25"></a><span class="kw">library</span>(MASS)</span>
<span id="cb28-26"><a href="#cb28-26"></a></span>
<span id="cb28-27"><a href="#cb28-27"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>N) { <span class="co">#for each epsilon</span></span>
<span id="cb28-28"><a href="#cb28-28"></a>  e &lt;-<span class="st"> </span>epsilon[j]</span>
<span id="cb28-29"><a href="#cb28-29"></a>  sktests &lt;-<span class="st"> </span><span class="kw">numeric</span>(m)</span>
<span id="cb28-30"><a href="#cb28-30"></a>  sktests &lt;-<span class="st"> </span><span class="kw">replicate</span>(m,<span class="dt">expr =</span> {</span>
<span id="cb28-31"><a href="#cb28-31"></a>    x &lt;-<span class="st"> </span><span class="kw">gen</span>(d,n,mu,sigma1,sigma2)</span>
<span id="cb28-32"><a href="#cb28-32"></a>    <span class="kw">as.integer</span>(<span class="kw">msk</span>(x) <span class="op">&gt;=</span><span class="st"> </span>cv2 <span class="op">|</span><span class="st"> </span><span class="kw">msk</span>(x) <span class="op">&lt;=</span><span class="st"> </span>cv1)</span>
<span id="cb28-33"><a href="#cb28-33"></a>  })</span>
<span id="cb28-34"><a href="#cb28-34"></a>  pwr[j] &lt;-<span class="st"> </span><span class="kw">mean</span>(sktests)</span>
<span id="cb28-35"><a href="#cb28-35"></a>}</span>
<span id="cb28-36"><a href="#cb28-36"></a><span class="kw">print</span>(pwr)</span></code></pre></div>
<pre><code>##  [1] 0.69 0.65 0.48 0.44 0.39 0.34 0.34 0.34 0.29 0.19 0.31 0.15 0.25 0.18 0.18
## [16] 0.14 0.13 0.11 0.10 0.11 0.10 0.23 0.22 0.15 0.22 0.27 0.37 0.43 0.43 0.46
## [31] 0.58 0.60 0.61 0.65</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="kw">plot</span>(epsilon, pwr, <span class="dt">type =</span> <span class="st">&quot;b&quot;</span>,<span class="dt">xlab =</span> <span class="kw">bquote</span>(epsilon), <span class="dt">ylim =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>))</span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="kw">abline</span>(<span class="dt">h =</span> <span class="fl">.1</span>, <span class="dt">lty =</span> <span class="dv">3</span>,<span class="dt">col =</span> <span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>when <span class="math inline">\(\epsilon \in (0.2,0.4))\)</span>,the power is close to 0.1, the power is highest when ε is about 0 and 1.</p>
</div>
<div id="question-4-2" class="section level2">
<h2>Question 4</h2>
<p>If we obtain the powers for two methods under a particular simulation setting with 10,000 experiments: say, 0.651 for one method and 0.676 for another method. Can we say the powers are different at 0.05 level?</p>
<p>1.What is the corresponding hypothesis test problem?</p>
<p>2.What test should we use? Z-test, two-sample t-test, paired-t test or McNemar test?</p>
<p>3.What information is needed to test your hypothesis?</p>
</div>
<div id="answer-4-2" class="section level2">
<h2>Answer 4</h2>
<p>1.<span class="math inline">\(power_1\)</span>:the power of the first method under a particular simulation;<span class="math inline">\(power_2\)</span>:the power of the second method under a particular simulation.</p>
<p>the corresponding hypothesis test problem:</p>
<p><span class="math inline">\(H_{0}:\frac{power_1}{power_2}=1\)</span> or <span class="math inline">\(H_{0}:power_1-power_2=0\)</span></p>
<p>2.we can use Z-test, paired-t test and McNemar test</p>
<p>3.3.For these test, what we already know is the number of experiments and the value of power(the probability that we reject the null hypothesis correctly). To conduct this test, we also need to know the significance of both methods for each sample.</p>
</div>
</div>
<div id="section-5" class="section level1">
<h1>2020-11-03</h1>
<p>7.1 Compute a jackknife estimate of the bias and the standard error of the correlation statistic in Example 7.2.</p>
<div id="answer-1-4" class="section level2">
<h2>Answer 1</h2>
<p>For jackknife method,</p>
<p><span class="math inline">\(\hat{bias}(\hat{\theta})=(n-1)(\bar{\theta}^*-\hat{\theta})\)</span></p>
<p><span class="math inline">\(\hat{se}(\hat{\theta})=\sqrt{\frac{(n-1)}{n}\sum_i(\theta_i^*-\hat{\theta})^2}\)</span></p>
<p>For two datas ‘law’ and ‘law82’,compute a jackknife estimate of the bias and the standard error of the correlation statistic:</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1"></a><span class="kw">library</span>(bootstrap)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;bootstrap&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1"></a><span class="co"># 15 law schools.</span></span>
<span id="cb33-2"><a href="#cb33-2"></a><span class="co">#jackknife estimate of bias and standard error </span></span>
<span id="cb33-3"><a href="#cb33-3"></a>n1 &lt;-<span class="st"> </span><span class="kw">nrow</span>(law)  <span class="co">#sample size</span></span>
<span id="cb33-4"><a href="#cb33-4"></a>corr1.hat &lt;-<span class="st"> </span><span class="kw">cor</span>(law[,<span class="dv">1</span>], law[,<span class="dv">2</span>])</span>
<span id="cb33-5"><a href="#cb33-5"></a>corr1.star &lt;-<span class="st"> </span><span class="kw">numeric</span>(n1)</span>
<span id="cb33-6"><a href="#cb33-6"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n1) {</span>
<span id="cb33-7"><a href="#cb33-7"></a>  laww &lt;-<span class="st"> </span>law[<span class="op">-</span>i,]</span>
<span id="cb33-8"><a href="#cb33-8"></a>  corr1.star[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(laww[,<span class="dv">1</span>], laww[,<span class="dv">2</span>])</span>
<span id="cb33-9"><a href="#cb33-9"></a>}</span>
<span id="cb33-10"><a href="#cb33-10"></a>bias.law &lt;-<span class="st"> </span>(n1<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(corr1.star)<span class="op">-</span>corr1.hat)</span>
<span id="cb33-11"><a href="#cb33-11"></a>se.law &lt;-<span class="st"> </span>(n1<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">sum</span>((corr1.star<span class="op">-</span><span class="kw">mean</span>(corr1.star))<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>n1</span>
<span id="cb33-12"><a href="#cb33-12"></a>e.law &lt;-<span class="st"> </span><span class="kw">c</span>(bias.law,se.law)</span>
<span id="cb33-13"><a href="#cb33-13"></a><span class="kw">names</span>(e.law) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;bias&#39;</span>,<span class="st">&#39;se&#39;</span>)</span>
<span id="cb33-14"><a href="#cb33-14"></a></span>
<span id="cb33-15"><a href="#cb33-15"></a><span class="co"># 82 law schools</span></span>
<span id="cb33-16"><a href="#cb33-16"></a><span class="co">#jackknife estimate of bias and standard error</span></span>
<span id="cb33-17"><a href="#cb33-17"></a>n2 &lt;-<span class="st"> </span><span class="kw">nrow</span>(law82)  <span class="co">#sample size</span></span>
<span id="cb33-18"><a href="#cb33-18"></a>corr2.hat &lt;-<span class="st"> </span><span class="kw">cor</span>(law82[,<span class="dv">1</span>], law82[,<span class="dv">2</span>])</span>
<span id="cb33-19"><a href="#cb33-19"></a>corr2.star &lt;-<span class="st"> </span><span class="kw">numeric</span>(n2)</span>
<span id="cb33-20"><a href="#cb33-20"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n2) {</span>
<span id="cb33-21"><a href="#cb33-21"></a>  laww82 &lt;-<span class="st"> </span>law82[<span class="op">-</span>i,]</span>
<span id="cb33-22"><a href="#cb33-22"></a>  corr2.star[i] &lt;-<span class="st"> </span><span class="kw">cor</span>(laww82[,<span class="dv">1</span>], laww82[,<span class="dv">2</span>])</span>
<span id="cb33-23"><a href="#cb33-23"></a>}</span>
<span id="cb33-24"><a href="#cb33-24"></a>bias.law82 &lt;-<span class="st"> </span>(n2<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(corr2.star)<span class="op">-</span>corr2.hat)</span>
<span id="cb33-25"><a href="#cb33-25"></a>se.law82 &lt;-<span class="st"> </span>(n2<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">sum</span>((corr2.star<span class="op">-</span><span class="kw">mean</span>(corr2.star))<span class="op">^</span><span class="dv">2</span>))<span class="op">/</span>n2</span>
<span id="cb33-26"><a href="#cb33-26"></a>e.law82 &lt;-<span class="st"> </span><span class="kw">c</span>(bias.law82,se.law82)</span>
<span id="cb33-27"><a href="#cb33-27"></a><span class="kw">names</span>(e.law82) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;bias&#39;</span>,<span class="st">&#39;se&#39;</span>)</span>
<span id="cb33-28"><a href="#cb33-28"></a></span>
<span id="cb33-29"><a href="#cb33-29"></a>es &lt;-<span class="st"> </span><span class="kw">rbind</span>(e.law,e.law82)</span>
<span id="cb33-30"><a href="#cb33-30"></a>knitr<span class="op">::</span><span class="kw">kable</span>(es)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">bias</th>
<th align="right">se</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">e.law</td>
<td align="right">-0.0064736</td>
<td align="right">0.0203116</td>
</tr>
<tr class="even">
<td align="left">e.law82</td>
<td align="right">-0.0019114</td>
<td align="right">0.0112309</td>
</tr>
</tbody>
</table>
</div>
<div id="question-2-4" class="section level2">
<h2>Question 2</h2>
<p>7.5 Refer to Exercise 7.4. Compute 95% bootstrap confidence intervals for the mean time between failures <span class="math inline">\(1/\lambda\)</span> by the standard normal, basic, percentile, and BCa methods. Compare the intervals and explain why they may differ.</p>
</div>
<div id="answer-2-4" class="section level2">
<h2>Answer 2</h2>
<p>In exercise 7.4 , the times between failures <span class="math inline">\(T \sim Exp(\lambda)\)</span></p>
<p>suppose there are n observed samples <span class="math inline">\(T_1,...,T_n iid\sim Exp(\lambda)\)</span>,</p>
<p><span class="math inline">\(\ln L(\lambda) = \sum_{i=1}^{n}\log(\lambda e^{-\lambda T_i})=n\log \lambda-\lambda \sum_{i=1}^{n}T_i\)</span></p>
<p><span class="math inline">\(\frac{\partial \ln L}{\partial \lambda}=0\)</span>,<span class="math inline">\(1/\lambda =\frac{1}{n}\sum_{i=1}^{n}T_i=\bar{T}\)</span></p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="kw">library</span>(boot)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;boot&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>air &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(aircondit)</span>
<span id="cb36-2"><a href="#cb36-2"></a>theta.mean &lt;-<span class="st"> </span><span class="kw">mean</span>(air)      <span class="co">#1/lambda</span></span>
<span id="cb36-3"><a href="#cb36-3"></a></span>
<span id="cb36-4"><a href="#cb36-4"></a>boot.lambda &lt;-<span class="st"> </span><span class="cf">function</span>(x,i) <span class="kw">mean</span>(x[i])</span>
<span id="cb36-5"><a href="#cb36-5"></a>bs &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data =</span> air,<span class="dt">statistic =</span> boot.lambda,<span class="dt">R =</span> <span class="dv">1000</span>)</span>
<span id="cb36-6"><a href="#cb36-6"></a>ci &lt;-<span class="st"> </span><span class="kw">boot.ci</span>(bs,<span class="dt">type=</span><span class="kw">c</span>(<span class="st">&quot;norm&quot;</span>,<span class="st">&quot;basic&quot;</span>,<span class="st">&quot;perc&quot;</span>,<span class="st">&quot;bca&quot;</span>))</span>
<span id="cb36-7"><a href="#cb36-7"></a></span>
<span id="cb36-8"><a href="#cb36-8"></a>CI95 &lt;-<span class="st"> </span><span class="kw">rbind</span>(ci<span class="op">$</span>normal[<span class="dv">2</span><span class="op">:</span><span class="dv">3</span>],ci<span class="op">$</span>basic[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>],ci<span class="op">$</span>percent[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>],ci<span class="op">$</span>bca[<span class="dv">4</span><span class="op">:</span><span class="dv">5</span>])</span>
<span id="cb36-9"><a href="#cb36-9"></a><span class="kw">colnames</span>(CI95) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;L&#39;</span>,<span class="st">&#39;U&#39;</span>)</span>
<span id="cb36-10"><a href="#cb36-10"></a><span class="kw">row.names</span>(CI95) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;95% CI by the standard normal method:&#39;</span>,<span class="st">&#39;95% CI by the basic method:&#39;</span>,<span class="st">&#39;95% CI by the percentile method:&#39;</span>,<span class="st">&#39;95% CI by the BCa method:&#39;</span>)</span>
<span id="cb36-11"><a href="#cb36-11"></a></span>
<span id="cb36-12"><a href="#cb36-12"></a>knitr<span class="op">::</span><span class="kw">kable</span>(CI95)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">L</th>
<th align="right">U</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">95% CI by the standard normal method:</td>
<td align="right">33.52837</td>
<td align="right">181.8011</td>
</tr>
<tr class="even">
<td align="left">95% CI by the basic method:</td>
<td align="right">26.87356</td>
<td align="right">173.0000</td>
</tr>
<tr class="odd">
<td align="left">95% CI by the percentile method:</td>
<td align="right">43.16667</td>
<td align="right">189.2931</td>
</tr>
<tr class="even">
<td align="left">95% CI by the BCa method:</td>
<td align="right">52.70366</td>
<td align="right">209.9704</td>
</tr>
</tbody>
</table>
<p>The range of BCa intevel is the widest, the range of Basic intevel is the narrowest.</p>
<p>Due to different assumptions on the sample and different methods used, the calculated interval is different.</p>
</div>
<div id="question-3-4" class="section level2">
<h2>Question 3</h2>
<p>7.8 Refer to Exercise 7.7. Obtain the jackknife estimates of bias and standard error of <span class="math inline">\(\hat{\theta}\)</span>.</p>
</div>
<div id="answer-3-4" class="section level2">
<h2>Answer 3</h2>
<p><span class="math inline">\(\hat{\theta}=\frac{\hat{\lambda}_1}{\sum_{i=1}^{n}\hat{\lambda}_i}\)</span></p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1"></a><span class="kw">library</span>(bootstrap) <span class="co">#the data scor is in the package bootstrap</span></span>
<span id="cb37-2"><a href="#cb37-2"></a>n &lt;-<span class="st"> </span><span class="kw">nrow</span>(scor)</span>
<span id="cb37-3"><a href="#cb37-3"></a>lambda &lt;-<span class="st"> </span><span class="kw">eigen</span>(<span class="kw">cov</span>(scor))<span class="op">$</span>values</span>
<span id="cb37-4"><a href="#cb37-4"></a>theta.hat &lt;-<span class="st"> </span>lambda[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lambda)</span>
<span id="cb37-5"><a href="#cb37-5"></a>   </span>
<span id="cb37-6"><a href="#cb37-6"></a>theta.j &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb37-7"><a href="#cb37-7"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb37-8"><a href="#cb37-8"></a>  sscor &lt;-<span class="st"> </span>scor[<span class="op">-</span>i,]</span>
<span id="cb37-9"><a href="#cb37-9"></a>  ssigma &lt;-<span class="st"> </span><span class="kw">cov</span>(sscor)</span>
<span id="cb37-10"><a href="#cb37-10"></a>  lambda.j &lt;-<span class="st"> </span><span class="kw">eigen</span>(ssigma)<span class="op">$</span>values</span>
<span id="cb37-11"><a href="#cb37-11"></a>  theta.j[i] &lt;-<span class="st"> </span>lambda.j[<span class="dv">1</span>]<span class="op">/</span><span class="kw">sum</span>(lambda.j)</span>
<span id="cb37-12"><a href="#cb37-12"></a>}</span>
<span id="cb37-13"><a href="#cb37-13"></a>theta.j.bias &lt;-<span class="st"> </span>(n<span class="dv">-1</span>)<span class="op">*</span>(<span class="kw">mean</span>(theta.j)<span class="op">-</span>theta.hat)</span>
<span id="cb37-14"><a href="#cb37-14"></a>theta.j.se &lt;-<span class="st"> </span><span class="kw">sqrt</span>((n<span class="dv">-1</span>)<span class="op">*</span><span class="kw">var</span>(theta.j)<span class="op">/</span>n)</span>
<span id="cb37-15"><a href="#cb37-15"></a></span>
<span id="cb37-16"><a href="#cb37-16"></a>jack.p &lt;-<span class="st"> </span><span class="kw">c</span>(theta.j.bias,theta.j.se)</span>
<span id="cb37-17"><a href="#cb37-17"></a><span class="kw">names</span>(jack.p) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;bias&#39;</span>,<span class="st">&#39;se&#39;</span>)</span>
<span id="cb37-18"><a href="#cb37-18"></a></span>
<span id="cb37-19"><a href="#cb37-19"></a><span class="kw">print</span>(jack.p)</span></code></pre></div>
<pre><code>##        bias          se 
## 0.001069139 0.005312565</code></pre>
</div>
<div id="question-4-3" class="section level2">
<h2>Question 4</h2>
<p>7.11 In Example 7.18, leave-one-out (n-fold) cross validation was used to select the best fitting model. Use leave-two-out cross validation to compare the models.</p>
</div>
<div id="answer-4-3" class="section level2">
<h2>Answer 4</h2>
<p>Linear:<span class="math inline">\(Y=\beta_0+\beta_1 X+\varepsilon\)</span></p>
<p>Quadratic:<span class="math inline">\(Y=\beta_0+\beta_1 X+\beta_2 X^2+\varepsilon\)</span></p>
<p>Exponential:<span class="math inline">\(\log Y=\log \beta_0+\beta_1 X+\varepsilon\)</span></p>
<p>Log-Log:<span class="math inline">\(\log Y=\beta_0+\beta_1 \log X+\varepsilon\)</span></p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1"></a><span class="kw">library</span>(DAAG)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;DAAG&#39;是用R版本4.0.3 来建造的</code></pre>
<pre><code>## 载入需要的程辑包：lattice</code></pre>
<pre><code>## 
## 载入程辑包：&#39;lattice&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:boot&#39;:
## 
##     melanoma</code></pre>
<pre><code>## 
## 载入程辑包：&#39;DAAG&#39;</code></pre>
<pre><code>## The following object is masked from &#39;package:MASS&#39;:
## 
##     hills</code></pre>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a>chem &lt;-<span class="st"> </span>ironslag<span class="op">$</span>chemical    <span class="co">#变量名:x: chemical </span></span>
<span id="cb46-2"><a href="#cb46-2"></a>magn &lt;-<span class="st"> </span>ironslag<span class="op">$</span>magnetic    <span class="co">#变量名:y: magnetic</span></span>
<span id="cb46-3"><a href="#cb46-3"></a></span>
<span id="cb46-4"><a href="#cb46-4"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(magn)</span>
<span id="cb46-5"><a href="#cb46-5"></a></span>
<span id="cb46-6"><a href="#cb46-6"></a><span class="co"># for n-fold cross validation</span></span>
<span id="cb46-7"><a href="#cb46-7"></a><span class="co"># fit models on leave-two-out samples</span></span>
<span id="cb46-8"><a href="#cb46-8"></a>sa &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="kw">rep</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ceiling</span>(n<span class="op">/</span><span class="dv">2</span>),<span class="dv">2</span>),n,<span class="dt">replace =</span> F) <span class="co">#将数据分成14类</span></span>
<span id="cb46-9"><a href="#cb46-9"></a>e1 &lt;-<span class="st"> </span>e2 &lt;-<span class="st"> </span>e3 &lt;-<span class="st"> </span>e4 &lt;-<span class="st"> </span><span class="kw">numeric</span>(<span class="kw">ceiling</span>(n<span class="op">/</span><span class="dv">2</span>))</span>
<span id="cb46-10"><a href="#cb46-10"></a></span>
<span id="cb46-11"><a href="#cb46-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">ceiling</span>(n<span class="op">/</span><span class="dv">2</span>)) {</span>
<span id="cb46-12"><a href="#cb46-12"></a>  x &lt;-<span class="st"> </span>chem[sa<span class="op">!=</span>i]</span>
<span id="cb46-13"><a href="#cb46-13"></a>  y &lt;-<span class="st"> </span>magn[sa<span class="op">!=</span>i]</span>
<span id="cb46-14"><a href="#cb46-14"></a>  x.test &lt;-<span class="st"> </span>chem[sa<span class="op">==</span>i]</span>
<span id="cb46-15"><a href="#cb46-15"></a>  y.test &lt;-<span class="st"> </span>magn[sa<span class="op">==</span>i]</span>
<span id="cb46-16"><a href="#cb46-16"></a>  </span>
<span id="cb46-17"><a href="#cb46-17"></a>  J1 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb46-18"><a href="#cb46-18"></a>  yhat1 &lt;-<span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J1<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x.test</span>
<span id="cb46-19"><a href="#cb46-19"></a>  e1[i] &lt;-<span class="st"> </span><span class="kw">mean</span>((y.test <span class="op">-</span><span class="st"> </span>yhat1)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb46-20"><a href="#cb46-20"></a>  </span>
<span id="cb46-21"><a href="#cb46-21"></a>  J2 &lt;-<span class="st"> </span><span class="kw">lm</span>(y <span class="op">~</span><span class="st"> </span>x <span class="op">+</span><span class="st"> </span><span class="kw">I</span>(x<span class="op">^</span><span class="dv">2</span>))</span>
<span id="cb46-22"><a href="#cb46-22"></a>  yhat2 &lt;-<span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J2<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x.test <span class="op">+</span>J2<span class="op">$</span>coef[<span class="dv">3</span>] <span class="op">*</span><span class="st"> </span>x.test<span class="op">^</span><span class="dv">2</span></span>
<span id="cb46-23"><a href="#cb46-23"></a>  e2[i] &lt;-<span class="st"> </span><span class="kw">mean</span>((y.test <span class="op">-</span><span class="st"> </span>yhat2)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb46-24"><a href="#cb46-24"></a>  </span>
<span id="cb46-25"><a href="#cb46-25"></a>  J3 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span>x)</span>
<span id="cb46-26"><a href="#cb46-26"></a>  logyhat3 &lt;-<span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J3<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span>x.test</span>
<span id="cb46-27"><a href="#cb46-27"></a>  yhat3 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat3)</span>
<span id="cb46-28"><a href="#cb46-28"></a>  e3[i] &lt;-<span class="st"> </span><span class="kw">mean</span>((y.test <span class="op">-</span><span class="st"> </span>yhat3)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb46-29"><a href="#cb46-29"></a>  </span>
<span id="cb46-30"><a href="#cb46-30"></a>  J4 &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="kw">log</span>(y) <span class="op">~</span><span class="st"> </span><span class="kw">log</span>(x))</span>
<span id="cb46-31"><a href="#cb46-31"></a>  logyhat4 &lt;-<span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">1</span>] <span class="op">+</span><span class="st"> </span>J4<span class="op">$</span>coef[<span class="dv">2</span>] <span class="op">*</span><span class="st"> </span><span class="kw">log</span>(x.test)</span>
<span id="cb46-32"><a href="#cb46-32"></a>  yhat4 &lt;-<span class="st"> </span><span class="kw">exp</span>(logyhat4)</span>
<span id="cb46-33"><a href="#cb46-33"></a>  e4[i] &lt;-<span class="st"> </span><span class="kw">mean</span>((y.test <span class="op">-</span><span class="st"> </span>yhat4)<span class="op">^</span><span class="dv">2</span>)</span>
<span id="cb46-34"><a href="#cb46-34"></a>  </span>
<span id="cb46-35"><a href="#cb46-35"></a>}</span>
<span id="cb46-36"><a href="#cb46-36"></a></span>
<span id="cb46-37"><a href="#cb46-37"></a>E &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">mean</span>(e1),<span class="kw">mean</span>(e2),<span class="kw">mean</span>(e3),<span class="kw">mean</span>(e4))</span>
<span id="cb46-38"><a href="#cb46-38"></a><span class="kw">names</span>(E) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;Linear&#39;</span>,<span class="st">&#39;Quadratic&#39;</span>,<span class="st">&#39;Exponential&#39;</span>,<span class="st">&#39;Log-Log&#39;</span>)</span>
<span id="cb46-39"><a href="#cb46-39"></a><span class="kw">print</span>(E)</span></code></pre></div>
<pre><code>##      Linear   Quadratic Exponential     Log-Log 
##    19.26660    17.44692    18.14395    20.19249</code></pre>
<p>According to the prediction error criterion, Model 2, the quadratic model, would be the best fit for the data.</p>
<p>The fitted regression equation for Model 2 is <span class="math display">\[\hat{Y} = 24.49262 − 1.39334X + 0.05452X^2.\]</span></p>
</div>
</div>
<div id="section-6" class="section level1">
<h1>2020-11-10</h1>
<div id="question-1-4" class="section level2">
<h2>Question 1</h2>
<p>8.3 The Count 5 test for equal variances in Section 6.4 is based on the maximum number of extreme points. Example 6.15 shows that the Count 5 criterion is not applicable for unequal sample sizes. Implement a permutation test for equal variance based on the maximum number of extreme points that applies when sample sizes are not necessarily equal.</p>
</div>
<div id="answer-1-5" class="section level2">
<h2>Answer 1</h2>
<p>Set <span class="math inline">\(n_1=20\)</span>,<span class="math inline">\(n_2=30\)</span>,<span class="math inline">\(X,Y\)</span> are from the standard normal distribution.</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a>maxn &lt;-<span class="st"> </span><span class="cf">function</span>(x, y) {</span>
<span id="cb48-2"><a href="#cb48-2"></a>  <span class="co">#the maximum number of extreme points</span></span>
<span id="cb48-3"><a href="#cb48-3"></a>  X &lt;-<span class="st"> </span>x<span class="op">-</span><span class="kw">mean</span>(x)</span>
<span id="cb48-4"><a href="#cb48-4"></a>  Y &lt;-<span class="st"> </span>y<span class="op">-</span><span class="kw">mean</span>(y)</span>
<span id="cb48-5"><a href="#cb48-5"></a>  outx &lt;-<span class="st"> </span><span class="kw">sum</span>(X <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(Y)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(X <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(Y))</span>
<span id="cb48-6"><a href="#cb48-6"></a>  outy &lt;-<span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&gt;</span><span class="st"> </span><span class="kw">max</span>(X)) <span class="op">+</span><span class="st"> </span><span class="kw">sum</span>(Y <span class="op">&lt;</span><span class="st"> </span><span class="kw">min</span>(X))</span>
<span id="cb48-7"><a href="#cb48-7"></a>  <span class="kw">return</span>(<span class="kw">max</span>(<span class="kw">c</span>(outx, outy)))</span>
<span id="cb48-8"><a href="#cb48-8"></a>}</span>
<span id="cb48-9"><a href="#cb48-9"></a></span>
<span id="cb48-10"><a href="#cb48-10"></a>n1 &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb48-11"><a href="#cb48-11"></a>n2 &lt;-<span class="st"> </span><span class="dv">30</span></span>
<span id="cb48-12"><a href="#cb48-12"></a>n &lt;-<span class="st"> </span>n1<span class="op">+</span>n2</span>
<span id="cb48-13"><a href="#cb48-13"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb48-14"><a href="#cb48-14"></a>sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb48-15"><a href="#cb48-15"></a><span class="kw">set.seed</span>(<span class="dv">3432</span>)</span>
<span id="cb48-16"><a href="#cb48-16"></a>x &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n1, mu1, sigma1)</span>
<span id="cb48-17"><a href="#cb48-17"></a>y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(n2, mu2, sigma2)</span>
<span id="cb48-18"><a href="#cb48-18"></a>v &lt;-<span class="st"> </span><span class="kw">maxn</span>(x,y)</span>
<span id="cb48-19"><a href="#cb48-19"></a>z &lt;-<span class="st"> </span><span class="kw">c</span>(x,y)</span>
<span id="cb48-20"><a href="#cb48-20"></a>R &lt;-<span class="st"> </span><span class="dv">9999</span></span>
<span id="cb48-21"><a href="#cb48-21"></a><span class="co">#permutation test</span></span>
<span id="cb48-22"><a href="#cb48-22"></a>perm &lt;-<span class="st"> </span><span class="kw">replicate</span>(R,<span class="dt">expr =</span> {</span>
<span id="cb48-23"><a href="#cb48-23"></a>  sa &lt;-<span class="st"> </span><span class="kw">sample</span>(<span class="dv">1</span><span class="op">:</span>n, <span class="dt">size =</span> n1, <span class="dt">replace =</span> <span class="ot">FALSE</span>)</span>
<span id="cb48-24"><a href="#cb48-24"></a>  x1 &lt;-<span class="st"> </span>z[sa]<span class="op">-</span><span class="kw">mean</span>(z[sa])</span>
<span id="cb48-25"><a href="#cb48-25"></a>  y1 &lt;-<span class="st"> </span>z[<span class="op">-</span>sa]<span class="op">-</span><span class="kw">mean</span>(z[<span class="op">-</span>sa])</span>
<span id="cb48-26"><a href="#cb48-26"></a>  <span class="kw">maxn</span>(x1,y1)</span>
<span id="cb48-27"><a href="#cb48-27"></a>})</span>
<span id="cb48-28"><a href="#cb48-28"></a>p &lt;-<span class="st"> </span><span class="kw">mean</span>(<span class="kw">c</span>(v,perm) <span class="op">&gt;=</span><span class="st"> </span>v)</span>
<span id="cb48-29"><a href="#cb48-29"></a><span class="kw">print</span>(p)</span></code></pre></div>
<pre><code>## [1] 0.5587</code></pre>
<p>set <span class="math inline">\(\alpha=0.05\)</span>,<span class="math inline">\(\because \hat{p}=0.5587&gt;0.05\)</span>,therefore we can’t reject <span class="math inline">\(H_0\)</span> at significance level <span class="math inline">\(\alpha\)</span>. These two distributions are the same.</p>
</div>
<div id="question-2-5" class="section level2">
<h2>Question 2</h2>
<p>Design experiments for evaluating the performance of the NN, energy, and ball methods in various situations. (1)Unequal variances and equal expectations (2)Unequal variances and unequal expectations (3)Non-normal distributions: t distribution with 1 df (heavy-tailed distribution), bimodel distribution (mixture of two normal distributions) (4)Unbalanced samples (say, 1 case versus 10 controls) Note: The parameters should be chosen such that the powers are distinguishable (say, range from 0.3 to 0.8).</p>
</div>
<div id="answer-2-5" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a><span class="kw">library</span>(RANN)    <span class="co"># For NN method</span></span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;RANN&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a><span class="kw">library</span>(energy)  <span class="co"># For energy method</span></span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;energy&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="kw">library</span>(Ball)    <span class="co"># For Ball method</span></span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Ball&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1"></a><span class="kw">library</span>(boot)</span>
<span id="cb56-2"><a href="#cb56-2"></a></span>
<span id="cb56-3"><a href="#cb56-3"></a>Tn &lt;-<span class="st"> </span><span class="cf">function</span>(z,ix,sizes,k) {</span>
<span id="cb56-4"><a href="#cb56-4"></a>  n1 &lt;-<span class="st"> </span>sizes[<span class="dv">1</span>]</span>
<span id="cb56-5"><a href="#cb56-5"></a>  n2 &lt;-<span class="st"> </span>sizes[<span class="dv">2</span>]</span>
<span id="cb56-6"><a href="#cb56-6"></a>  n &lt;-<span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span>n2</span>
<span id="cb56-7"><a href="#cb56-7"></a>  <span class="cf">if</span>(<span class="kw">is.vector</span>(z)) z &lt;-<span class="st"> </span><span class="kw">data.frame</span>(z,<span class="dv">0</span>)</span>
<span id="cb56-8"><a href="#cb56-8"></a>  z &lt;-<span class="st"> </span>z[ix,];</span>
<span id="cb56-9"><a href="#cb56-9"></a>  NN &lt;-<span class="st"> </span><span class="kw">nn2</span>(<span class="dt">data=</span>z, <span class="dt">k=</span>k<span class="op">+</span><span class="dv">1</span>) <span class="co"># what&#39;s the first column?</span></span>
<span id="cb56-10"><a href="#cb56-10"></a>  block1 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[<span class="dv">1</span><span class="op">:</span>n1,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb56-11"><a href="#cb56-11"></a>  block2 &lt;-<span class="st"> </span>NN<span class="op">$</span>nn.idx[(n1<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n,<span class="op">-</span><span class="dv">1</span>]</span>
<span id="cb56-12"><a href="#cb56-12"></a>  i1 &lt;-<span class="st"> </span><span class="kw">sum</span>(block1 <span class="op">&lt;</span><span class="st"> </span>n1 <span class="op">+</span><span class="st"> </span><span class="fl">.5</span>)</span>
<span id="cb56-13"><a href="#cb56-13"></a>  i2 &lt;-<span class="st"> </span><span class="kw">sum</span>(block2 <span class="op">&gt;</span><span class="st"> </span>n1<span class="fl">+.5</span>)</span>
<span id="cb56-14"><a href="#cb56-14"></a>  (i1 <span class="op">+</span><span class="st"> </span>i2) <span class="op">/</span><span class="st"> </span>(k <span class="op">*</span><span class="st"> </span>n)</span>
<span id="cb56-15"><a href="#cb56-15"></a>}</span>
<span id="cb56-16"><a href="#cb56-16"></a></span>
<span id="cb56-17"><a href="#cb56-17"></a>eqdist.nn &lt;-<span class="st"> </span><span class="cf">function</span>(z,sizes,k){</span>
<span id="cb56-18"><a href="#cb56-18"></a>  boot.obj &lt;-<span class="st"> </span><span class="kw">boot</span>(<span class="dt">data=</span>z,<span class="dt">statistic=</span>Tn,<span class="dt">R=</span>R,<span class="dt">sim =</span> <span class="st">&quot;permutation&quot;</span>, <span class="dt">sizes =</span> sizes,<span class="dt">k=</span>k)</span>
<span id="cb56-19"><a href="#cb56-19"></a>  ts &lt;-<span class="st"> </span><span class="kw">c</span>(boot.obj<span class="op">$</span>t0,boot.obj<span class="op">$</span>t)</span>
<span id="cb56-20"><a href="#cb56-20"></a>  p.value &lt;-<span class="st"> </span><span class="kw">mean</span>(ts<span class="op">&gt;=</span>ts[<span class="dv">1</span>])</span>
<span id="cb56-21"><a href="#cb56-21"></a>  <span class="kw">list</span>(<span class="dt">statistic=</span>ts[<span class="dv">1</span>],<span class="dt">p.value=</span>p.value)</span>
<span id="cb56-22"><a href="#cb56-22"></a>}</span></code></pre></div>
<p>(1)Unequal variances and equal expectations</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb57-2"><a href="#cb57-2"></a>N &lt;-<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb57-3"><a href="#cb57-3"></a>m &lt;-<span class="st"> </span><span class="fl">1e3</span></span>
<span id="cb57-4"><a href="#cb57-4"></a>R &lt;-<span class="st"> </span><span class="dv">999</span></span>
<span id="cb57-5"><a href="#cb57-5"></a>d &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb57-6"><a href="#cb57-6"></a>k &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb57-7"><a href="#cb57-7"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb57-8"><a href="#cb57-8"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb57-9"><a href="#cb57-9"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">0.7</span></span>
<span id="cb57-10"><a href="#cb57-10"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb57-11"><a href="#cb57-11"></a></span>
<span id="cb57-12"><a href="#cb57-12"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb57-13"><a href="#cb57-13"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>d,mu1,sigma1),<span class="dt">ncol=</span>d)</span>
<span id="cb57-14"><a href="#cb57-14"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>d,mu2,sigma2),<span class="dt">ncol=</span>d)</span>
<span id="cb57-15"><a href="#cb57-15"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb57-16"><a href="#cb57-16"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb57-17"><a href="#cb57-17"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb57-18"><a href="#cb57-18"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">1818</span>)<span class="op">$</span>p.value</span>
<span id="cb57-19"><a href="#cb57-19"></a>}</span>
<span id="cb57-20"><a href="#cb57-20"></a></span>
<span id="cb57-21"><a href="#cb57-21"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb57-22"><a href="#cb57-22"></a>pow1 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb57-23"><a href="#cb57-23"></a><span class="kw">names</span>(pow1) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;p.NN&#39;</span>,<span class="st">&#39;p.energy&#39;</span>,<span class="st">&#39;p.Ball&#39;</span>)</span>
<span id="cb57-24"><a href="#cb57-24"></a><span class="kw">print</span>(pow1)</span></code></pre></div>
<pre><code>##     p.NN p.energy   p.Ball 
##    0.385    0.464    0.828</code></pre>
<p>(2)Unequal variances and unequal expectations</p>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb59-2"><a href="#cb59-2"></a>N &lt;-<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb59-3"><a href="#cb59-3"></a>m &lt;-<span class="st"> </span><span class="fl">1e3</span></span>
<span id="cb59-4"><a href="#cb59-4"></a>R &lt;-<span class="st"> </span><span class="dv">999</span></span>
<span id="cb59-5"><a href="#cb59-5"></a>d &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb59-6"><a href="#cb59-6"></a>k &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb59-7"><a href="#cb59-7"></a>mu1 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb59-8"><a href="#cb59-8"></a>mu2 &lt;-<span class="st"> </span><span class="fl">0.35</span></span>
<span id="cb59-9"><a href="#cb59-9"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb59-10"><a href="#cb59-10"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">0.8</span></span>
<span id="cb59-11"><a href="#cb59-11"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb59-12"><a href="#cb59-12"></a></span>
<span id="cb59-13"><a href="#cb59-13"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb59-14"><a href="#cb59-14"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>d,mu1,sigma1),<span class="dt">ncol=</span>d)</span>
<span id="cb59-15"><a href="#cb59-15"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>d,mu2,sigma2),<span class="dt">ncol=</span>d)</span>
<span id="cb59-16"><a href="#cb59-16"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb59-17"><a href="#cb59-17"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb59-18"><a href="#cb59-18"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span><span class="dv">999</span>)<span class="op">$</span>p.value</span>
<span id="cb59-19"><a href="#cb59-19"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">2626</span>)<span class="op">$</span>p.value</span>
<span id="cb59-20"><a href="#cb59-20"></a>}</span>
<span id="cb59-21"><a href="#cb59-21"></a></span>
<span id="cb59-22"><a href="#cb59-22"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.1</span></span>
<span id="cb59-23"><a href="#cb59-23"></a>pow2 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb59-24"><a href="#cb59-24"></a><span class="kw">names</span>(pow2) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;p.NN&#39;</span>,<span class="st">&#39;p.energy&#39;</span>,<span class="st">&#39;p.Ball&#39;</span>)</span>
<span id="cb59-25"><a href="#cb59-25"></a><span class="kw">print</span>(pow2)</span></code></pre></div>
<pre><code>##     p.NN p.energy   p.Ball 
##    0.438    0.843    0.834</code></pre>
<p>(3)Non-normal distributions</p>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1"></a>n1 &lt;-<span class="st"> </span>n2 &lt;-<span class="st"> </span><span class="dv">50</span></span>
<span id="cb61-2"><a href="#cb61-2"></a>N &lt;-<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb61-3"><a href="#cb61-3"></a>m &lt;-<span class="st"> </span><span class="fl">1e3</span></span>
<span id="cb61-4"><a href="#cb61-4"></a>R &lt;-<span class="st"> </span><span class="dv">999</span></span>
<span id="cb61-5"><a href="#cb61-5"></a>d &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb61-6"><a href="#cb61-6"></a>k &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb61-7"><a href="#cb61-7"></a>mu1 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb61-8"><a href="#cb61-8"></a>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb61-9"><a href="#cb61-9"></a>sigma1 &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb61-10"><a href="#cb61-10"></a>sigma2 &lt;-<span class="st"> </span><span class="fl">1.2</span></span>
<span id="cb61-11"><a href="#cb61-11"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb61-12"><a href="#cb61-12"></a> <span class="co">#x:t distribution with 1 df</span></span>
<span id="cb61-13"><a href="#cb61-13"></a> <span class="co">#y:t bimodel distribution</span></span>
<span id="cb61-14"><a href="#cb61-14"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb61-15"><a href="#cb61-15"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rt</span>(n1<span class="op">*</span>d,<span class="dt">df=</span><span class="dv">1</span>),<span class="dt">ncol=</span>d);</span>
<span id="cb61-16"><a href="#cb61-16"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">sample</span>(<span class="kw">c</span>(<span class="kw">rnorm</span>(n2,mu1,sigma1),<span class="kw">rnorm</span>(n2,mu2,sigma2))),<span class="dt">ncol=</span>d)</span>
<span id="cb61-17"><a href="#cb61-17"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb61-18"><a href="#cb61-18"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb61-19"><a href="#cb61-19"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb61-20"><a href="#cb61-20"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">4535</span>)<span class="op">$</span>p.value</span>
<span id="cb61-21"><a href="#cb61-21"></a>}</span>
<span id="cb61-22"><a href="#cb61-22"></a></span>
<span id="cb61-23"><a href="#cb61-23"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.05</span></span>
<span id="cb61-24"><a href="#cb61-24"></a>pow3 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb61-25"><a href="#cb61-25"></a><span class="kw">names</span>(pow3) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;p.NN&#39;</span>,<span class="st">&#39;p.energy&#39;</span>,<span class="st">&#39;p.Ball&#39;</span>)</span>
<span id="cb61-26"><a href="#cb61-26"></a><span class="kw">print</span>(pow3)</span></code></pre></div>
<pre><code>##     p.NN p.energy   p.Ball 
##    0.320    0.733    0.614</code></pre>
<p>(4)Unbalanced samples</p>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>n1 &lt;-<span class="st"> </span><span class="dv">10</span></span>
<span id="cb63-2"><a href="#cb63-2"></a>n2 &lt;-<span class="st"> </span><span class="dv">20</span></span>
<span id="cb63-3"><a href="#cb63-3"></a>N &lt;-<span class="st"> </span><span class="kw">c</span>(n1,n2)</span>
<span id="cb63-4"><a href="#cb63-4"></a>m &lt;-<span class="st"> </span><span class="fl">1e3</span></span>
<span id="cb63-5"><a href="#cb63-5"></a>R &lt;-<span class="st"> </span><span class="dv">999</span></span>
<span id="cb63-6"><a href="#cb63-6"></a>d &lt;-<span class="st"> </span><span class="dv">2</span></span>
<span id="cb63-7"><a href="#cb63-7"></a>k &lt;-<span class="st"> </span><span class="dv">3</span></span>
<span id="cb63-8"><a href="#cb63-8"></a>mu1 &lt;-<span class="st"> </span>mu2 &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb63-9"><a href="#cb63-9"></a>sigma1 &lt;-<span class="st"> </span>sigma2 &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb63-10"><a href="#cb63-10"></a>p.values &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="ot">NA</span>,m,<span class="dv">3</span>)</span>
<span id="cb63-11"><a href="#cb63-11"></a></span>
<span id="cb63-12"><a href="#cb63-12"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>m){</span>
<span id="cb63-13"><a href="#cb63-13"></a>  x &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n1<span class="op">*</span>d,mu1,sigma1),<span class="dt">ncol=</span>d)</span>
<span id="cb63-14"><a href="#cb63-14"></a>  y &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">rnorm</span>(n2<span class="op">*</span>d,mu2,sigma2),<span class="dt">ncol=</span>d)</span>
<span id="cb63-15"><a href="#cb63-15"></a>  z &lt;-<span class="st"> </span><span class="kw">rbind</span>(x,y)</span>
<span id="cb63-16"><a href="#cb63-16"></a>  p.values[i,<span class="dv">1</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.nn</span>(z,N,k)<span class="op">$</span>p.value</span>
<span id="cb63-17"><a href="#cb63-17"></a>  p.values[i,<span class="dv">2</span>] &lt;-<span class="st"> </span><span class="kw">eqdist.etest</span>(z,<span class="dt">sizes=</span>N,<span class="dt">R=</span>R)<span class="op">$</span>p.value</span>
<span id="cb63-18"><a href="#cb63-18"></a>  p.values[i,<span class="dv">3</span>] &lt;-<span class="st"> </span><span class="kw">bd.test</span>(<span class="dt">x=</span>x,<span class="dt">y=</span>y,<span class="dt">R=</span><span class="dv">999</span>,<span class="dt">seed=</span>i<span class="op">*</span><span class="dv">1234</span>)<span class="op">$</span>p.value</span>
<span id="cb63-19"><a href="#cb63-19"></a>}</span>
<span id="cb63-20"><a href="#cb63-20"></a></span>
<span id="cb63-21"><a href="#cb63-21"></a>alpha &lt;-<span class="st"> </span><span class="fl">0.3</span></span>
<span id="cb63-22"><a href="#cb63-22"></a>pow4 &lt;-<span class="st"> </span><span class="kw">colMeans</span>(p.values<span class="op">&lt;</span>alpha)</span>
<span id="cb63-23"><a href="#cb63-23"></a><span class="kw">names</span>(pow4) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;p.NN&#39;</span>,<span class="st">&#39;p.energy&#39;</span>,<span class="st">&#39;p.Ball&#39;</span>)</span>
<span id="cb63-24"><a href="#cb63-24"></a><span class="kw">print</span>(pow4)</span></code></pre></div>
<pre><code>##     p.NN p.energy   p.Ball 
##    0.253    0.313    0.287</code></pre>
</div>
</div>
<div id="section-7" class="section level1">
<h1>2020-11-17</h1>
<div id="question-1-5" class="section level2">
<h2>Question 1</h2>
<p>9.4 Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
</div>
<div id="answer-1-6" class="section level2">
<h2>Answer 1</h2>
<p>The standard Laplace distribution has density <span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|},x\in R\)</span>. Variance of the standard Laplace distribution is 2.</p>
<p><span class="math inline">\(r(x_t,y)=\frac{f(Y)}{f(X_t)}=\frac{\frac{1}{2}e^{-|Y|}}{\frac{1}{2}e^{-|X_t|}}=e^{|X_t|-|Y|}\)</span></p>
<p>Metropolis sampler:</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="co"># a function to generate the chain, given the</span></span>
<span id="cb65-2"><a href="#cb65-2"></a><span class="co"># parameters n and σ, initial value X0, and the length of the chain, N.</span></span>
<span id="cb65-3"><a href="#cb65-3"></a>rwM.gen.chain &lt;-<span class="st"> </span><span class="cf">function</span>(sigma,x0,N) {</span>
<span id="cb65-4"><a href="#cb65-4"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb65-5"><a href="#cb65-5"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb65-6"><a href="#cb65-6"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb65-7"><a href="#cb65-7"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb65-8"><a href="#cb65-8"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb65-9"><a href="#cb65-9"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb65-10"><a href="#cb65-10"></a>    r &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>])<span class="op">-</span><span class="kw">abs</span>(y))</span>
<span id="cb65-11"><a href="#cb65-11"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>r){</span>
<span id="cb65-12"><a href="#cb65-12"></a>      x[i] &lt;-<span class="st"> </span>y </span>
<span id="cb65-13"><a href="#cb65-13"></a>      k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb65-14"><a href="#cb65-14"></a>      } <span class="cf">else</span> </span>
<span id="cb65-15"><a href="#cb65-15"></a>        x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb65-16"><a href="#cb65-16"></a>    }</span>
<span id="cb65-17"><a href="#cb65-17"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x,<span class="dt">accept=</span>k<span class="op">/</span>N )) </span>
<span id="cb65-18"><a href="#cb65-18"></a>  <span class="co"># accept:the acceptance rates of chain</span></span>
<span id="cb65-19"><a href="#cb65-19"></a>}</span>
<span id="cb65-20"><a href="#cb65-20"></a></span>
<span id="cb65-21"><a href="#cb65-21"></a>N &lt;-<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb65-22"><a href="#cb65-22"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>,<span class="dv">2</span>,<span class="dv">16</span>)</span>
<span id="cb65-23"><a href="#cb65-23"></a></span>
<span id="cb65-24"><a href="#cb65-24"></a>x0 &lt;-<span class="st"> </span><span class="dv">5</span>   <span class="co"># start = 5</span></span>
<span id="cb65-25"><a href="#cb65-25"></a>ch1 &lt;-<span class="st"> </span><span class="kw">rwM.gen.chain</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb65-26"><a href="#cb65-26"></a>ch2 &lt;-<span class="st"> </span><span class="kw">rwM.gen.chain</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb65-27"><a href="#cb65-27"></a>ch3 &lt;-<span class="st"> </span><span class="kw">rwM.gen.chain</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb65-28"><a href="#cb65-28"></a>ch4 &lt;-<span class="st"> </span><span class="kw">rwM.gen.chain</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb65-29"><a href="#cb65-29"></a></span>
<span id="cb65-30"><a href="#cb65-30"></a>accep &lt;-<span class="st"> </span><span class="kw">c</span>(ch1<span class="op">$</span>accept, ch2<span class="op">$</span>accept, ch3<span class="op">$</span>accept, ch4<span class="op">$</span>accept)</span>
<span id="cb65-31"><a href="#cb65-31"></a><span class="kw">names</span>(accep) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;sigma=0.05&#39;</span>,<span class="st">&#39;sigma=0.5&#39;</span>,<span class="st">&#39;sigma=2&#39;</span>,<span class="st">&#39;sigma=16&#39;</span>)</span>
<span id="cb65-32"><a href="#cb65-32"></a><span class="kw">print</span>(accep)</span></code></pre></div>
<pre><code>## sigma=0.05  sigma=0.5    sigma=2   sigma=16 
##     0.9815     0.8335     0.5255     0.0915</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="kw">plot</span>(ch1<span class="op">$</span>x,<span class="dt">type =</span><span class="st">&#39;l&#39;</span>,<span class="dt">main =</span><span class="st">&#39;sigma = 0.05&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1"></a><span class="kw">plot</span>(ch2<span class="op">$</span>x,<span class="dt">type =</span><span class="st">&#39;l&#39;</span>,<span class="dt">main =</span><span class="st">&#39;sigma = 0.5&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1"></a><span class="kw">plot</span>(ch3<span class="op">$</span>x,<span class="dt">type =</span><span class="st">&#39;l&#39;</span>,<span class="dt">main =</span><span class="st">&#39;sigma = 2&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="kw">plot</span>(ch4<span class="op">$</span>x,<span class="dt">type =</span><span class="st">&#39;l&#39;</span>,<span class="dt">main =</span><span class="st">&#39;sigma = 16&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>As the variance of the proposal distribution increases, the acceptance rate of the chain decreases.</p>
<p>Chain 1 has not converged to the target in 2000 iterations. Chain 2 is converging very slower than Chain 3 and requires a longer burn-in period. Chain 3 is mixing well and converging to the target distribution after a short burn-in period. Chain 4 converges, but it is inefficient,the ratios <span class="math inline">\(r(X_t, Y)\)</span> are smaller and most of the candidate points are rejected.</p>
</div>
<div id="question-2-6" class="section level2">
<h2>Question 2</h2>
<p>For Exercise 9.4, use the Gelman-Rubin method to monitor convergence of the chain, and run the chain until it converges approximately to the target distribution according to <span class="math inline">\(\hat{R} &lt; 1.2\)</span>.</p>
</div>
<div id="answer-2-6" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1"></a>Gelman.Rubin &lt;-<span class="st"> </span><span class="cf">function</span>(psi) {</span>
<span id="cb71-2"><a href="#cb71-2"></a>  <span class="co"># psi[i,j] is the statistic psi(X[i,1:j]) for chain in i-th row of X</span></span>
<span id="cb71-3"><a href="#cb71-3"></a>  <span class="co"># generate r.hat</span></span>
<span id="cb71-4"><a href="#cb71-4"></a>  psi &lt;-<span class="st"> </span><span class="kw">as.matrix</span>(psi)</span>
<span id="cb71-5"><a href="#cb71-5"></a>  n &lt;-<span class="st"> </span><span class="kw">ncol</span>(psi)</span>
<span id="cb71-6"><a href="#cb71-6"></a>  k &lt;-<span class="st"> </span><span class="kw">nrow</span>(psi)</span>
<span id="cb71-7"><a href="#cb71-7"></a>  psi.i &lt;-<span class="st"> </span><span class="kw">rowMeans</span>(psi)            <span class="co">#row means</span></span>
<span id="cb71-8"><a href="#cb71-8"></a>  B &lt;-<span class="st"> </span>n<span class="op">*</span><span class="kw">var</span>(psi.i)                 <span class="co">#between variance est.</span></span>
<span id="cb71-9"><a href="#cb71-9"></a>  psi.w &lt;-<span class="st"> </span><span class="kw">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>)     <span class="co">#within variances</span></span>
<span id="cb71-10"><a href="#cb71-10"></a>  W &lt;-<span class="st"> </span><span class="kw">mean</span>(psi.w)                  <span class="co">#within est.</span></span>
<span id="cb71-11"><a href="#cb71-11"></a>  hat.v.psi &lt;-<span class="st"> </span>W<span class="op">*</span>(n<span class="dv">-1</span>)<span class="op">/</span>n <span class="op">+</span><span class="st"> </span>(B<span class="op">/</span>n)    <span class="co">#upper variance est.</span></span>
<span id="cb71-12"><a href="#cb71-12"></a>  r.hat &lt;-<span class="st"> </span>hat.v.psi<span class="op">/</span>W              <span class="co">#G-R statistic</span></span>
<span id="cb71-13"><a href="#cb71-13"></a>  <span class="kw">return</span>(r.hat)</span>
<span id="cb71-14"><a href="#cb71-14"></a>}</span>
<span id="cb71-15"><a href="#cb71-15"></a></span>
<span id="cb71-16"><a href="#cb71-16"></a><span class="co">#use the function &#39;rwM.gen.chain&#39; in answer 1 to generate the chain</span></span>
<span id="cb71-17"><a href="#cb71-17"></a></span>
<span id="cb71-18"><a href="#cb71-18"></a>sigma &lt;-<span class="st"> </span><span class="dv">2</span>          <span class="co">#parameter of proposal distribution</span></span>
<span id="cb71-19"><a href="#cb71-19"></a>k &lt;-<span class="st"> </span><span class="dv">4</span>              <span class="co">#number of chains to generate</span></span>
<span id="cb71-20"><a href="#cb71-20"></a>n &lt;-<span class="st"> </span><span class="dv">15000</span>          <span class="co">#length of chains</span></span>
<span id="cb71-21"><a href="#cb71-21"></a>b &lt;-<span class="st"> </span><span class="dv">1000</span>           <span class="co">#burn-in length</span></span>
<span id="cb71-22"><a href="#cb71-22"></a></span>
<span id="cb71-23"><a href="#cb71-23"></a><span class="co">#choose overdispersed initial values</span></span>
<span id="cb71-24"><a href="#cb71-24"></a>x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>,<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb71-25"><a href="#cb71-25"></a></span>
<span id="cb71-26"><a href="#cb71-26"></a><span class="co">#generate the chains</span></span>
<span id="cb71-27"><a href="#cb71-27"></a>X &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>n)</span>
<span id="cb71-28"><a href="#cb71-28"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) X[i,] &lt;-<span class="st"> </span><span class="kw">rwM.gen.chain</span>(sigma,x0[i],n)<span class="op">$</span>x</span>
<span id="cb71-29"><a href="#cb71-29"></a></span>
<span id="cb71-30"><a href="#cb71-30"></a><span class="co">#compute diagnostic statistics</span></span>
<span id="cb71-31"><a href="#cb71-31"></a>psi &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X, <span class="dv">1</span>, cumsum))</span>
<span id="cb71-32"><a href="#cb71-32"></a></span>
<span id="cb71-33"><a href="#cb71-33"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi)) psi[i,] &lt;-<span class="st"> </span>psi[i,]<span class="op">/</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi))</span>
<span id="cb71-34"><a href="#cb71-34"></a>r &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi)</span>
<span id="cb71-35"><a href="#cb71-35"></a><span class="kw">cat</span>(<span class="st">&#39;r.hat=&#39;</span>,r)</span></code></pre></div>
<pre><code>## r.hat= 1.099286</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1"></a><span class="co">#plot psi for the four chains</span></span>
<span id="cb73-2"><a href="#cb73-2"></a></span>
<span id="cb73-3"><a href="#cb73-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k) <span class="kw">plot</span>(psi[i, (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>,<span class="dt">xlab=</span>i, <span class="dt">ylab=</span><span class="kw">bquote</span>(psi))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1"></a>    <span class="co">#restore default</span></span>
<span id="cb74-2"><a href="#cb74-2"></a></span>
<span id="cb74-3"><a href="#cb74-3"></a><span class="co">#plot the sequence of R-hat statistics</span></span>
<span id="cb74-4"><a href="#cb74-4"></a>rhat &lt;-<span class="st"> </span><span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb74-5"><a href="#cb74-5"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n) rhat[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb74-6"><a href="#cb74-6"></a></span>
<span id="cb74-7"><a href="#cb74-7"></a><span class="kw">plot</span>(rhat[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb74-8"><a href="#cb74-8"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>The value of <span class="math inline">\(\hat{R}\)</span> is below 1.2 at about 2000 iterations and below 1.1 at about 8000 iterations.</p>
<p>set different <span class="math inline">\(\sigma\)</span> of the proposal distribution.<span class="math inline">\(\sigma=0.05,0.5,2,4\)</span>.</p>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a>sigma &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.05</span>,<span class="fl">0.5</span>,<span class="dv">2</span>,<span class="dv">4</span>)</span>
<span id="cb75-2"><a href="#cb75-2"></a>k &lt;-<span class="st"> </span><span class="dv">4</span>              <span class="co">#number of chains to generate</span></span>
<span id="cb75-3"><a href="#cb75-3"></a>n &lt;-<span class="st"> </span><span class="dv">15000</span>          <span class="co">#length of chains</span></span>
<span id="cb75-4"><a href="#cb75-4"></a>b &lt;-<span class="st"> </span><span class="dv">1000</span> </span>
<span id="cb75-5"><a href="#cb75-5"></a></span>
<span id="cb75-6"><a href="#cb75-6"></a>x0 &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="op">-</span><span class="dv">10</span>,<span class="op">-</span><span class="dv">5</span>,<span class="dv">5</span>,<span class="dv">10</span>)</span>
<span id="cb75-7"><a href="#cb75-7"></a>X1 &lt;-<span class="st"> </span>X2 &lt;-<span class="st"> </span>X3 &lt;-<span class="st"> </span>X4 &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dt">nrow=</span>k,<span class="dt">ncol=</span>n)</span>
<span id="cb75-8"><a href="#cb75-8"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>k){</span>
<span id="cb75-9"><a href="#cb75-9"></a>  X1[i,] &lt;-<span class="st"> </span><span class="kw">rwM.gen.chain</span>(sigma[<span class="dv">1</span>],x0[i],n)<span class="op">$</span>x</span>
<span id="cb75-10"><a href="#cb75-10"></a>  X2[i,] &lt;-<span class="st"> </span><span class="kw">rwM.gen.chain</span>(sigma[<span class="dv">2</span>],x0[i],n)<span class="op">$</span>x</span>
<span id="cb75-11"><a href="#cb75-11"></a>  X3[i,] &lt;-<span class="st"> </span><span class="kw">rwM.gen.chain</span>(sigma[<span class="dv">3</span>],x0[i],n)<span class="op">$</span>x</span>
<span id="cb75-12"><a href="#cb75-12"></a>  X4[i,] &lt;-<span class="st"> </span><span class="kw">rwM.gen.chain</span>(sigma[<span class="dv">4</span>],x0[i],n)<span class="op">$</span>x</span>
<span id="cb75-13"><a href="#cb75-13"></a>}</span>
<span id="cb75-14"><a href="#cb75-14"></a>psi1 &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X1,<span class="dv">1</span>,cumsum))</span>
<span id="cb75-15"><a href="#cb75-15"></a>psi2 &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X2,<span class="dv">1</span>,cumsum))</span>
<span id="cb75-16"><a href="#cb75-16"></a>psi3 &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X3,<span class="dv">1</span>,cumsum))</span>
<span id="cb75-17"><a href="#cb75-17"></a>psi4 &lt;-<span class="st"> </span><span class="kw">t</span>(<span class="kw">apply</span>(X4,<span class="dv">1</span>,cumsum))</span>
<span id="cb75-18"><a href="#cb75-18"></a></span>
<span id="cb75-19"><a href="#cb75-19"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(psi1)){</span>
<span id="cb75-20"><a href="#cb75-20"></a>  psi1[i,] &lt;-<span class="st"> </span>psi1[i,]<span class="op">/</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi1))</span>
<span id="cb75-21"><a href="#cb75-21"></a>  psi2[i,] &lt;-<span class="st"> </span>psi2[i,]<span class="op">/</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi2))</span>
<span id="cb75-22"><a href="#cb75-22"></a>  psi3[i,] &lt;-<span class="st"> </span>psi3[i,]<span class="op">/</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi3))</span>
<span id="cb75-23"><a href="#cb75-23"></a>  psi4[i,] &lt;-<span class="st"> </span>psi4[i,]<span class="op">/</span>(<span class="dv">1</span><span class="op">:</span><span class="kw">ncol</span>(psi4))</span>
<span id="cb75-24"><a href="#cb75-24"></a>}</span>
<span id="cb75-25"><a href="#cb75-25"></a></span>
<span id="cb75-26"><a href="#cb75-26"></a>rhat1 &lt;-<span class="st"> </span>rhat2 &lt;-<span class="st"> </span>rhat3 &lt;-<span class="st"> </span>rhat4 &lt;-<span class="kw">rep</span>(<span class="dv">0</span>, n)</span>
<span id="cb75-27"><a href="#cb75-27"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n){</span>
<span id="cb75-28"><a href="#cb75-28"></a>  rhat1[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi1[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb75-29"><a href="#cb75-29"></a>  rhat2[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi2[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb75-30"><a href="#cb75-30"></a>  rhat3[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi3[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb75-31"><a href="#cb75-31"></a>  rhat4[j] &lt;-<span class="st"> </span><span class="kw">Gelman.Rubin</span>(psi4[,<span class="dv">1</span><span class="op">:</span>j])</span>
<span id="cb75-32"><a href="#cb75-32"></a>}</span>
<span id="cb75-33"><a href="#cb75-33"></a></span>
<span id="cb75-34"><a href="#cb75-34"></a><span class="kw">plot</span>(rhat1[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R1&quot;</span>)</span>
<span id="cb75-35"><a href="#cb75-35"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1"></a><span class="kw">plot</span>(rhat2[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R2&quot;</span>)</span>
<span id="cb76-2"><a href="#cb76-2"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="kw">plot</span>(rhat3[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R3&quot;</span>)</span>
<span id="cb77-2"><a href="#cb77-2"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1"></a><span class="kw">plot</span>(rhat4[(b<span class="op">+</span><span class="dv">1</span>)<span class="op">:</span>n], <span class="dt">type=</span><span class="st">&quot;l&quot;</span>, <span class="dt">xlab=</span><span class="st">&quot;&quot;</span>, <span class="dt">ylab=</span><span class="st">&quot;R4&quot;</span>)</span>
<span id="cb78-2"><a href="#cb78-2"></a><span class="kw">abline</span>(<span class="dt">h=</span><span class="fl">1.2</span>, <span class="dt">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="question-3-5" class="section level2">
<h2>Question 3</h2>
<p>11.4 Find the intersection points <span class="math inline">\(A(k)\)</span> in <span class="math inline">\((0,\sqrt{k})\)</span> of the curves <span class="math display">\[S_{k-1}(a)=P\left(t(k-1)&gt;\sqrt{\frac{a^2(k-1)}{k-a^2}} \right)\]</span> and <span class="math display">\[S_{k}(a)=P\left(t(k)&gt;\sqrt{\frac{a^2k}{k+1-a^2}} \right)\]</span> for k = 4:25, 100, 500, 1000, where t(k) is a Student t random variable with k degrees of freedom. (These intersection points determine the critical values for a t-test for scale-mixture errors proposed by Szekely [260].)</p>
</div>
<div id="answer-3-5" class="section level2">
<h2>Answer 3</h2>
<p>For<span class="math inline">\(S_{k}(a)=P\left(t(k)&gt;\sqrt{\frac{a^2k}{k+1-a^2}} \right)\)</span>,<span class="math inline">\(\because k&gt;0,\therefore k+1-a^2&gt;0,i.e.-\sqrt{k+1}&lt;a&lt;\sqrt{k+1}\)</span>.</p>
<p><span class="math inline">\(\because S_{k-1}(a)\)</span> doesn’t make sense at <span class="math inline">\(a=\sqrt{k}\)</span>,and <span class="math inline">\(S_{k-1}(0)=S_{k}(0)\)</span>,<span class="math inline">\(\therefore\)</span> we set the interval to <span class="math inline">\((0.00001,\sqrt{k}-0.00001)\)</span> in the code.</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a> <span class="co">#the function of s_k(a)</span></span>
<span id="cb79-2"><a href="#cb79-2"></a>sk &lt;-<span class="st"> </span><span class="cf">function</span>(a,k) <span class="dv">1</span><span class="op">-</span><span class="kw">pt</span>(<span class="kw">sqrt</span>(a<span class="op">^</span><span class="dv">2</span><span class="op">*</span>k<span class="op">/</span>(k<span class="op">+</span><span class="dv">1</span><span class="op">-</span>a<span class="op">^</span><span class="dv">2</span>)),k)</span>
<span id="cb79-3"><a href="#cb79-3"></a> <span class="co">#the equation to solve the intersection points</span></span>
<span id="cb79-4"><a href="#cb79-4"></a>equa &lt;-<span class="st"> </span><span class="cf">function</span>(a,k) <span class="kw">sk</span>(a,k)<span class="op">-</span><span class="kw">sk</span>(a,k<span class="dv">-1</span>) </span>
<span id="cb79-5"><a href="#cb79-5"></a> <span class="co">#the interval that the intersection points in is (0,sqrt(k))</span></span>
<span id="cb79-6"><a href="#cb79-6"></a></span>
<span id="cb79-7"><a href="#cb79-7"></a>k =<span class="st"> </span><span class="kw">c</span>(<span class="dv">4</span><span class="op">:</span><span class="dv">25</span>,<span class="dv">100</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb79-8"><a href="#cb79-8"></a></span>
<span id="cb79-9"><a href="#cb79-9"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(k)</span>
<span id="cb79-10"><a href="#cb79-10"></a>Ak &lt;-<span class="st"> </span><span class="kw">numeric</span>(n)</span>
<span id="cb79-11"><a href="#cb79-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb79-12"><a href="#cb79-12"></a>  Ak[i] &lt;-<span class="st"> </span><span class="kw">uniroot</span>(<span class="cf">function</span>(y) {<span class="kw">equa</span>(y,k[i])},<span class="dt">lower =</span> <span class="fl">0.00001</span>,<span class="dt">upper =</span> <span class="kw">sqrt</span>(k[i])<span class="op">-</span><span class="fl">0.00001</span>)<span class="op">$</span>root</span>
<span id="cb79-13"><a href="#cb79-13"></a>}</span>
<span id="cb79-14"><a href="#cb79-14"></a><span class="kw">names</span>(Ak) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="kw">rep</span>(<span class="st">&#39;k=&#39;</span>,n),k,<span class="dt">sep=</span><span class="st">&#39;&#39;</span>)</span>
<span id="cb79-15"><a href="#cb79-15"></a></span>
<span id="cb79-16"><a href="#cb79-16"></a>knitr<span class="op">::</span><span class="kw">kable</span>(Ak)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">x</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">k=4</td>
<td align="right">1.492103</td>
</tr>
<tr class="even">
<td align="left">k=5</td>
<td align="right">1.533548</td>
</tr>
<tr class="odd">
<td align="left">k=6</td>
<td align="right">1.562768</td>
</tr>
<tr class="even">
<td align="left">k=7</td>
<td align="right">1.584421</td>
</tr>
<tr class="odd">
<td align="left">k=8</td>
<td align="right">1.601182</td>
</tr>
<tr class="even">
<td align="left">k=9</td>
<td align="right">1.614523</td>
</tr>
<tr class="odd">
<td align="left">k=10</td>
<td align="right">1.625387</td>
</tr>
<tr class="even">
<td align="left">k=11</td>
<td align="right">1.634409</td>
</tr>
<tr class="odd">
<td align="left">k=12</td>
<td align="right">1.642025</td>
</tr>
<tr class="even">
<td align="left">k=13</td>
<td align="right">1.648540</td>
</tr>
<tr class="odd">
<td align="left">k=14</td>
<td align="right">1.654177</td>
</tr>
<tr class="even">
<td align="left">k=15</td>
<td align="right">1.659098</td>
</tr>
<tr class="odd">
<td align="left">k=16</td>
<td align="right">1.663451</td>
</tr>
<tr class="even">
<td align="left">k=17</td>
<td align="right">1.667288</td>
</tr>
<tr class="odd">
<td align="left">k=18</td>
<td align="right">1.670736</td>
</tr>
<tr class="even">
<td align="left">k=19</td>
<td align="right">1.673841</td>
</tr>
<tr class="odd">
<td align="left">k=20</td>
<td align="right">1.676589</td>
</tr>
<tr class="even">
<td align="left">k=21</td>
<td align="right">1.679139</td>
</tr>
<tr class="odd">
<td align="left">k=22</td>
<td align="right">1.681461</td>
</tr>
<tr class="even">
<td align="left">k=23</td>
<td align="right">4.795821</td>
</tr>
<tr class="odd">
<td align="left">k=24</td>
<td align="right">4.898969</td>
</tr>
<tr class="even">
<td align="left">k=25</td>
<td align="right">4.999990</td>
</tr>
<tr class="odd">
<td align="left">k=100</td>
<td align="right">9.999990</td>
</tr>
<tr class="even">
<td align="left">k=500</td>
<td align="right">22.360670</td>
</tr>
<tr class="odd">
<td align="left">k=1000</td>
<td align="right">31.622767</td>
</tr>
</tbody>
</table>
<p>As <span class="math inline">\(k\)</span> increases, the intersection point gets closer and closer to <span class="math inline">\(\sqrt{k}\)</span>.</p>
</div>
</div>
<div id="section-8" class="section level1">
<h1>2020-11-24</h1>
<div id="question-1-6" class="section level2">
<h2>Question 1</h2>
<p>A-B-O blood type problem:</p>
<p><span class="math inline">\(\cdot\)</span> Let the three alleles be A, B, and O.</p>
<table>
<thead>
<tr class="header">
<th align="center">Genotype</th>
<th align="center">AA</th>
<th align="center">BB</th>
<th align="center">OO</th>
<th align="center">AO</th>
<th align="center">BO</th>
<th align="center">AB</th>
<th align="center">Sum</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center">Frequency</td>
<td align="center">p^2</td>
<td align="center">q^2</td>
<td align="center">r^2</td>
<td align="center">2pr</td>
<td align="center">2qr</td>
<td align="center">2pq</td>
<td align="center">1</td>
</tr>
<tr class="even">
<td align="center">Count</td>
<td align="center">nAA</td>
<td align="center">nBB</td>
<td align="center">nOO</td>
<td align="center">nAO</td>
<td align="center">nBO</td>
<td align="center">nAB</td>
<td align="center">n</td>
</tr>
</tbody>
</table>
<p><span class="math inline">\(\cdot\)</span> Observed data: <span class="math inline">\(n_{A·} = n_{AA} + n_{AO} = 444\)</span> (A-type),<span class="math inline">\(n_{B·} = n_{BB} + n_{BO} = 132\)</span> (B-type), <span class="math inline">\(n_{OO} = 361\)</span> (O-type),<span class="math inline">\(n_{AB} = 63\)</span> (AB-type).</p>
<p><span class="math inline">\(\cdot\)</span> Use EM algorithm to solve MLE of p and q (consider missing data <span class="math inline">\(n_{AA}\)</span> and <span class="math inline">\(n_{BB}\)</span>).</p>
<p><span class="math inline">\(\cdot\)</span> Record the values of p and q that maximize the conditional likelihood in each EM steps, calculate the corresponding log-maximum likelihood values (for observed data), are they increasing?</p>
</div>
<div id="answer-1-7" class="section level2">
<h2>Answer 1</h2>
<p><span class="math inline">\(p+q+r=1,r=1-p-q\)</span></p>
<p>Observed data: <span class="math inline">\(n_{A·} = n_{AA} + n_{AO} = 444\)</span> (A-type),<span class="math inline">\(n_{B·} = n_{BB} + n_{BO} = 132\)</span> (B-type), <span class="math inline">\(n_{OO} = 361\)</span> (O-type),<span class="math inline">\(n_{AB} = 63\)</span> (AB-type)</p>
<p><span class="math display">\[
n_{AA}|n_{A\cdot}\sim B(n_{A\cdot},\frac{p^2}{p^2+2pr})=B(444,\frac{p}{p+2r}), n_{BB}|n_{B\cdot}\sim B(n_{B\cdot},\frac{q^2}{q^2+2qr})=B(132,\frac{q}{q+2r}) 
\]</span> Observed data likelihood: <span class="math display">\[
\begin{aligned}
L(p,q|n_{A·},n_{B·},n_{OO},n_{AB})&amp;=(p^2+2pr)^{n_{A·}}(q^2+2qr)^{n_{B·}}(r^2)^{n_{OO}}(2pq)^{n_{AB}} \\
&amp;=(p^2+2pr)^{444}(q^2+2qr)^{132}(r^2)^{361}(2pq)^{63} \\
\end{aligned}
\]</span> get <span class="math inline">\(\hat{p}_0,\hat{q}_0\)</span>.</p>
<p>Complete data likelihood: <span class="math display">\[
\begin{aligned}
 L(p,q|n_{AA},n_{AO},n_{BB},n_{BO},n_{OO},n_{AB})&amp;=(p^2)^{n_{AA}}(2pr)^{n_{AO}}(q^2)^{n_{BB}}(2qr)^{n_{BO}}(r^2)^{n_{OO}}(2pq)^{n_{AB}} \\
 l(p,q|n_{A·},n_{B·},n_{AA},n_{BB},n_{OO},n_{AB})&amp;=\ln L(p,q|n_{A·},n_{B·},n_{AA},n_{BB},n_{OO},n_{AB}) \\
 &amp;=\ln \{(p^2)^{n_{AA}}(2pr)^{n_{A·}-n_{AA}}(q^2)^{n_{BB}}(2qr)^{n_{B·}-n_{BB}}(r^2)^{n_{OO}}(2pq)^{n_{AB}}\} \\
 &amp;=\ln \{(p^2)^{n_{AA}}(2pr)^{n_{A·}-n_{AA}}(q^2)^{n_{BB}}(2qr)^{n_{B·}-n_{BB}}(r^2)^{n_{OO}}(2pq)^{n_{AB}}\} \\
 &amp;=\ln \{(\frac{p^2}{2pr})^{n_{AA}}(2pr)^{n_{A·}}(\frac{q^2}{2qr})^{n_{BB}}(2qr)^{n_{B·}}(r^2)^{n_{OO}}(2pq)^{n_{AB}}\} \\
 &amp;=n_{AA}\ln(\frac{p}{2r})+n_{A·}\ln (2pr)+n_{BB}\ln(\frac{q}{2r})+n_{B·}\ln (2qr)+ \\
 &amp; n_{OO}\ln r^2+n_{AB}\ln (2pq) \\
\end{aligned}
\]</span> E-step: <span class="math display">\[
\begin{aligned}
&amp; E_{\hat{p},\hat{q}}[l(p,q|n_{A·},n_{B·},n_{AA},n_{BB},n_{OO},n_{AB})|n_{A·},n_{B·},n_{OO},n_{AB}] \\
=&amp; \frac{\hat{p}n_{A·}}{\hat{p}+2\hat{r}}\ln(\frac{p}{2r})+n_{A·}\ln (2pr)+\frac{\hat{q}n_{B·}}{\hat{q}+2\hat{r}}\ln(\frac{q}{2r})+n_{B·}\ln (2qr)+n_{OO}\ln r^2+n_{AB}\ln (2pq)
\end{aligned}
\]</span></p>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1"></a>obl &lt;-<span class="st"> </span><span class="cf">function</span>(x){</span>
<span id="cb80-2"><a href="#cb80-2"></a>  <span class="co"># Observed data likelihood</span></span>
<span id="cb80-3"><a href="#cb80-3"></a>  p &lt;-<span class="st"> </span>x[<span class="dv">1</span>]</span>
<span id="cb80-4"><a href="#cb80-4"></a>  q &lt;-<span class="st"> </span>x[<span class="dv">2</span>]</span>
<span id="cb80-5"><a href="#cb80-5"></a>  r &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q</span>
<span id="cb80-6"><a href="#cb80-6"></a>  f &lt;-<span class="st"> </span><span class="dv">444</span><span class="op">*</span><span class="kw">log</span>(p<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>p<span class="op">*</span>r) <span class="op">+</span><span class="st"> </span><span class="dv">132</span><span class="op">*</span><span class="kw">log</span>(q<span class="op">^</span><span class="dv">2</span><span class="op">+</span><span class="dv">2</span><span class="op">*</span>q<span class="op">*</span>r) <span class="op">+</span><span class="st"> </span><span class="dv">2</span><span class="op">*</span><span class="dv">361</span><span class="op">*</span><span class="kw">log</span>(r) <span class="op">+</span><span class="st"> </span><span class="dv">63</span><span class="op">*</span>(<span class="kw">log</span>(<span class="dv">2</span>)<span class="op">+</span><span class="kw">log</span>(p)<span class="op">+</span><span class="kw">log</span>(q))</span>
<span id="cb80-7"><a href="#cb80-7"></a>  <span class="kw">return</span>(<span class="op">-</span>f)</span>
<span id="cb80-8"><a href="#cb80-8"></a>}</span>
<span id="cb80-9"><a href="#cb80-9"></a></span>
<span id="cb80-10"><a href="#cb80-10"></a>e_step &lt;-<span class="st"> </span><span class="cf">function</span>(x,phat,qhat,rhat){</span>
<span id="cb80-11"><a href="#cb80-11"></a>  p &lt;-<span class="st"> </span>x[<span class="dv">1</span>]</span>
<span id="cb80-12"><a href="#cb80-12"></a>  q &lt;-<span class="st"> </span>x[<span class="dv">2</span>]</span>
<span id="cb80-13"><a href="#cb80-13"></a>  r &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p<span class="op">-</span>q</span>
<span id="cb80-14"><a href="#cb80-14"></a>  f &lt;-<span class="st"> </span>phat<span class="op">*</span><span class="dv">444</span><span class="op">*</span>(<span class="kw">log</span>(p)<span class="op">-</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>r))<span class="op">/</span>(phat<span class="op">+</span><span class="dv">2</span><span class="op">*</span>rhat) <span class="op">+</span><span class="st"> </span><span class="dv">444</span><span class="op">*</span>(<span class="kw">log</span>(<span class="dv">2</span>)<span class="op">+</span><span class="kw">log</span>(p)<span class="op">+</span><span class="kw">log</span>(r)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb80-15"><a href="#cb80-15"></a><span class="st">    </span>qhat<span class="op">*</span><span class="dv">132</span><span class="op">*</span>(<span class="kw">log</span>(q)<span class="op">-</span><span class="kw">log</span>(<span class="dv">2</span><span class="op">*</span>r))<span class="op">/</span>(qhat<span class="op">+</span><span class="dv">2</span><span class="op">*</span>rhat) <span class="op">+</span><span class="st"> </span><span class="dv">132</span><span class="op">*</span>(<span class="kw">log</span>(<span class="dv">2</span>)<span class="op">+</span><span class="kw">log</span>(q)<span class="op">+</span><span class="kw">log</span>(r)) <span class="op">+</span><span class="st"> </span></span>
<span id="cb80-16"><a href="#cb80-16"></a><span class="st">    </span><span class="dv">2</span><span class="op">*</span><span class="dv">361</span><span class="op">*</span><span class="kw">log</span>(r) <span class="op">+</span><span class="dv">63</span><span class="op">*</span>(<span class="kw">log</span>(<span class="dv">2</span>)<span class="op">+</span><span class="kw">log</span>(p)<span class="op">+</span><span class="kw">log</span>(q))</span>
<span id="cb80-17"><a href="#cb80-17"></a>  <span class="kw">return</span>(<span class="op">-</span>f)</span>
<span id="cb80-18"><a href="#cb80-18"></a>}</span>
<span id="cb80-19"><a href="#cb80-19"></a>theta0 &lt;-<span class="st"> </span><span class="kw">optim</span>(<span class="kw">c</span>(<span class="fl">0.35</span>,<span class="fl">0.2</span>),<span class="dt">fn=</span>obl)<span class="op">$</span>par</span>
<span id="cb80-20"><a href="#cb80-20"></a>theta &lt;-<span class="st"> </span><span class="kw">list</span>()   <span class="co"># a list to store phat and qhat</span></span>
<span id="cb80-21"><a href="#cb80-21"></a>theta[[<span class="dv">1</span>]] &lt;-<span class="st"> </span>theta1 &lt;-<span class="st"> </span>theta0</span>
<span id="cb80-22"><a href="#cb80-22"></a>k &lt;-<span class="st"> </span><span class="dv">1</span></span>
<span id="cb80-23"><a href="#cb80-23"></a>judge &lt;-<span class="st"> </span>T</span>
<span id="cb80-24"><a href="#cb80-24"></a><span class="cf">while</span> (judge <span class="op">==</span><span class="st"> </span>T) {</span>
<span id="cb80-25"><a href="#cb80-25"></a>  theta0 &lt;-<span class="st"> </span>theta1</span>
<span id="cb80-26"><a href="#cb80-26"></a>  p.hat &lt;-<span class="st"> </span>theta0[<span class="dv">1</span>]</span>
<span id="cb80-27"><a href="#cb80-27"></a>  q.hat &lt;-<span class="st"> </span>theta0[<span class="dv">2</span>]</span>
<span id="cb80-28"><a href="#cb80-28"></a>  r.hat &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">-</span>p.hat<span class="op">-</span>q.hat</span>
<span id="cb80-29"><a href="#cb80-29"></a>  com.likeli &lt;-<span class="st"> </span><span class="cf">function</span>(x) <span class="kw">e_step</span>(x,p.hat,q.hat,r.hat) <span class="co">#E-step</span></span>
<span id="cb80-30"><a href="#cb80-30"></a>  theta1 &lt;-<span class="st"> </span><span class="kw">optim</span>(theta0,<span class="dt">fn=</span>com.likeli)<span class="op">$</span>par <span class="co">#M-step</span></span>
<span id="cb80-31"><a href="#cb80-31"></a>   <span class="co"># judge whether to stop the iteration:if judge=T,go on</span></span>
<span id="cb80-32"><a href="#cb80-32"></a>  judge &lt;-<span class="st"> </span><span class="kw">abs</span>(theta0[<span class="dv">1</span>]<span class="op">-</span>theta1[<span class="dv">1</span>])<span class="op">&gt;</span><span class="fl">1e-8</span> <span class="op">|</span><span class="st"> </span><span class="kw">abs</span>(theta0[<span class="dv">2</span>]<span class="op">-</span>theta1[<span class="dv">2</span>])<span class="op">&gt;</span><span class="fl">1e-8</span></span>
<span id="cb80-33"><a href="#cb80-33"></a>  k &lt;-<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span></span>
<span id="cb80-34"><a href="#cb80-34"></a>  theta[[k]] &lt;-<span class="st"> </span>theta1</span>
<span id="cb80-35"><a href="#cb80-35"></a>}</span>
<span id="cb80-36"><a href="#cb80-36"></a>prtheta &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="kw">unlist</span>(theta),<span class="dt">byrow=</span>T,<span class="dt">ncol=</span><span class="dv">2</span>)</span>
<span id="cb80-37"><a href="#cb80-37"></a><span class="kw">colnames</span>(prtheta) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;phat&#39;</span>,<span class="st">&#39;qhat&#39;</span>)</span>
<span id="cb80-38"><a href="#cb80-38"></a><span class="kw">print</span>(prtheta)</span></code></pre></div>
<pre><code>##           phat      qhat
## [1,] 0.2975828 0.1027041
## [2,] 0.2976605 0.1027219
## [3,] 0.2976240 0.1027210
## [4,] 0.2976240 0.1027210</code></pre>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a>corllv &lt;-<span class="st"> </span><span class="op">-</span><span class="kw">sapply</span>(theta, obl)</span>
<span id="cb82-2"><a href="#cb82-2"></a><span class="kw">cat</span>(<span class="st">&#39;the corresponding log-maximum likelihood values are not increasing:&#39;</span>,<span class="st">&#39;</span><span class="ch">\n</span><span class="st">&#39;</span>,corllv)</span></code></pre></div>
<pre><code>## the corresponding log-maximum likelihood values are not increasing: 
##  -1169.822 -1169.822 -1169.822 -1169.822</code></pre>
<p>The corresponding log-maximum likelihood values are not increasing.</p>
</div>
<div id="question-2-7" class="section level2">
<h2>Question 2</h2>
<p>Exercises 3 (page 204, Advanced R).</p>
<p>3.Use both for loops and lapply() to fit linear models to the mtcars using the formulas stored in this list:</p>
<p>formulas &lt;- list( mpg ~ disp, mpg ~ I(1 / disp), mpg ~ disp + wt, mpg ~ I(1 / disp) + wt )</p>
</div>
<div id="answer-2-7" class="section level2">
<h2>Answer 2</h2>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="kw">attach</span>(mtcars)</span>
<span id="cb84-2"><a href="#cb84-2"></a>formulas &lt;-<span class="st"> </span><span class="kw">list</span>(</span>
<span id="cb84-3"><a href="#cb84-3"></a>  mpg <span class="op">~</span><span class="st"> </span>disp,</span>
<span id="cb84-4"><a href="#cb84-4"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp),</span>
<span id="cb84-5"><a href="#cb84-5"></a>  mpg <span class="op">~</span><span class="st"> </span>disp <span class="op">+</span><span class="st"> </span>wt,</span>
<span id="cb84-6"><a href="#cb84-6"></a>  mpg <span class="op">~</span><span class="st"> </span><span class="kw">I</span>(<span class="dv">1</span> <span class="op">/</span><span class="st"> </span>disp) <span class="op">+</span><span class="st"> </span>wt</span>
<span id="cb84-7"><a href="#cb84-7"></a>)</span>
<span id="cb84-8"><a href="#cb84-8"></a> <span class="co">#使用for循环</span></span>
<span id="cb84-9"><a href="#cb84-9"></a>n &lt;-<span class="st"> </span><span class="kw">length</span>(formulas)</span>
<span id="cb84-10"><a href="#cb84-10"></a>fit1 &lt;-<span class="st"> </span><span class="kw">list</span>()</span>
<span id="cb84-11"><a href="#cb84-11"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span>n) {</span>
<span id="cb84-12"><a href="#cb84-12"></a>  fit1[[i]] &lt;-<span class="st"> </span><span class="kw">lm</span>(<span class="dt">formula =</span> formulas[[i]])</span>
<span id="cb84-13"><a href="#cb84-13"></a>}</span>
<span id="cb84-14"><a href="#cb84-14"></a> <span class="co">#使用lapply()</span></span>
<span id="cb84-15"><a href="#cb84-15"></a>fit2 &lt;-<span class="st"> </span><span class="kw">lapply</span>(formulas,lm)</span>
<span id="cb84-16"><a href="#cb84-16"></a><span class="kw">detach</span>(mtcars)</span>
<span id="cb84-17"><a href="#cb84-17"></a></span>
<span id="cb84-18"><a href="#cb84-18"></a><span class="kw">print</span>(fit1)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## lm(formula = formulas[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="kw">print</span>(fit2)</span></code></pre></div>
<pre><code>## [[1]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp  
##    29.59985     -0.04122  
## 
## 
## [[2]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)  
##       10.75      1557.67  
## 
## 
## [[3]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)         disp           wt  
##    34.96055     -0.01772     -3.35083  
## 
## 
## [[4]]
## 
## Call:
## FUN(formula = X[[i]])
## 
## Coefficients:
## (Intercept)    I(1/disp)           wt  
##      19.024     1142.560       -1.798</code></pre>
</div>
<div id="question-3-6" class="section level2">
<h2>Question 3</h2>
<p>Excecises 3 and 6 (page 213-214, Advanced R). Note: the anonymous function is defined in Section 10.2 (page 181, Advanced R)</p>
<ol start="3" style="list-style-type: decimal">
<li>The following code simulates the performance of a t-test for non-normal data. Use sapply() and an anonymous function to extract the p-value from every trial.</li>
</ol>
<p>trials &lt;- replicate(100,t.test(rpois(10, 10), rpois(7, 10)),simplify = FALSE)</p>
<p>Extra challenge: get rid of the anonymous function by using [[ directly.</p>
</div>
<div id="answer-3-6" class="section level2">
<h2>Answer 3</h2>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a>trials &lt;-<span class="st"> </span><span class="kw">replicate</span>(<span class="dv">100</span>,<span class="kw">t.test</span>(<span class="kw">rpois</span>(<span class="dv">10</span>, <span class="dv">10</span>), <span class="kw">rpois</span>(<span class="dv">7</span>, <span class="dv">10</span>)),<span class="dt">simplify =</span> <span class="ot">FALSE</span>)</span>
<span id="cb88-2"><a href="#cb88-2"></a></span>
<span id="cb88-3"><a href="#cb88-3"></a> <span class="co"># Use sapply() and an anonymous function</span></span>
<span id="cb88-4"><a href="#cb88-4"></a>p_value1 &lt;-<span class="st"> </span><span class="kw">sapply</span>(trials,<span class="cf">function</span>(x) x<span class="op">$</span>p.value)</span>
<span id="cb88-5"><a href="#cb88-5"></a><span class="kw">print</span>(p_value1)</span></code></pre></div>
<pre><code>##   [1] 0.31150803 0.70510408 0.66541061 0.30816493 0.98369607 0.17245675
##   [7] 0.63918834 0.01146574 0.74676349 0.83941982 0.34846713 0.95245087
##  [13] 0.42555089 0.84937756 0.73801765 0.52535757 0.48148170 0.90020486
##  [19] 0.48687995 0.92429034 0.19271531 0.74917244 0.93166570 0.93166228
##  [25] 0.92517174 0.93367545 0.79525774 0.96389757 0.18954212 0.87075482
##  [31] 0.34635255 0.85491883 0.13634576 0.54899714 0.18652278 0.65166304
##  [37] 0.75690799 0.15547016 0.22139698 0.50251270 0.48108960 0.36092102
##  [43] 0.55735404 0.22624071 0.33880853 0.59379697 0.49544179 0.84301502
##  [49] 0.60560028 0.84070263 0.60082707 0.78811486 0.27087977 0.81057521
##  [55] 0.41610595 0.04130181 0.88625754 0.28170764 0.53143410 0.30937236
##  [61] 0.53756983 0.85398966 0.98267309 0.46457502 0.62220831 0.89680508
##  [67] 0.48271344 0.73917697 0.13502411 0.98723621 0.16516892 0.02890845
##  [73] 0.20328768 0.73873431 0.50288986 0.68056226 0.44219502 0.57397368
##  [79] 0.13471981 0.60561456 0.44652384 0.90065822 0.82492317 0.88127543
##  [85] 0.82781307 0.31919508 0.16500373 0.26864248 0.71789218 0.90679087
##  [91] 0.82893009 0.36790259 0.57806382 0.55610160 0.37787645 0.66263253
##  [97] 0.14480833 0.20935937 0.23071605 0.87507939</code></pre>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a> <span class="co"># using [[ directly</span></span>
<span id="cb90-2"><a href="#cb90-2"></a>p_value2 &lt;-<span class="st"> </span><span class="kw">numeric</span>()</span>
<span id="cb90-3"><a href="#cb90-3"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="kw">length</span>(trials)) {</span>
<span id="cb90-4"><a href="#cb90-4"></a>  p_value2[i] &lt;-<span class="st"> </span>trials[[i]]<span class="op">$</span>p.value</span>
<span id="cb90-5"><a href="#cb90-5"></a>}</span>
<span id="cb90-6"><a href="#cb90-6"></a><span class="kw">print</span>(p_value2)</span></code></pre></div>
<pre><code>##   [1] 0.31150803 0.70510408 0.66541061 0.30816493 0.98369607 0.17245675
##   [7] 0.63918834 0.01146574 0.74676349 0.83941982 0.34846713 0.95245087
##  [13] 0.42555089 0.84937756 0.73801765 0.52535757 0.48148170 0.90020486
##  [19] 0.48687995 0.92429034 0.19271531 0.74917244 0.93166570 0.93166228
##  [25] 0.92517174 0.93367545 0.79525774 0.96389757 0.18954212 0.87075482
##  [31] 0.34635255 0.85491883 0.13634576 0.54899714 0.18652278 0.65166304
##  [37] 0.75690799 0.15547016 0.22139698 0.50251270 0.48108960 0.36092102
##  [43] 0.55735404 0.22624071 0.33880853 0.59379697 0.49544179 0.84301502
##  [49] 0.60560028 0.84070263 0.60082707 0.78811486 0.27087977 0.81057521
##  [55] 0.41610595 0.04130181 0.88625754 0.28170764 0.53143410 0.30937236
##  [61] 0.53756983 0.85398966 0.98267309 0.46457502 0.62220831 0.89680508
##  [67] 0.48271344 0.73917697 0.13502411 0.98723621 0.16516892 0.02890845
##  [73] 0.20328768 0.73873431 0.50288986 0.68056226 0.44219502 0.57397368
##  [79] 0.13471981 0.60561456 0.44652384 0.90065822 0.82492317 0.88127543
##  [85] 0.82781307 0.31919508 0.16500373 0.26864248 0.71789218 0.90679087
##  [91] 0.82893009 0.36790259 0.57806382 0.55610160 0.37787645 0.66263253
##  [97] 0.14480833 0.20935937 0.23071605 0.87507939</code></pre>
</div>
<div id="question-4-4" class="section level2">
<h2>Question 4</h2>
<ol start="6" style="list-style-type: decimal">
<li>Implement a combination of Map() and vapply() to create an lapply() variant that iterates in parallel over all of its inputs and stores its outputs in a vector (or a matrix). What arguments should the function take?</li>
</ol>
</div>
<div id="answer-4-4" class="section level2">
<h2>Answer 4</h2>
<p>stores its outputs in a vector: FUN.VALUE=numeric(1)</p>
<p>stores its outputs in a matrix: FUN.VALUE=numeric(n), n=length(result)&gt;1</p>
<p>stores its outputs in an array: FUN.VALUE=matrix(…), the size of the matrix is equal to the result of the function.</p>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a> <span class="co"># lapply() variant</span></span>
<span id="cb92-2"><a href="#cb92-2"></a>valapply &lt;-<span class="st"> </span><span class="cf">function</span>(X,FUN,FUN.VALUE,<span class="dt">USE.NAMES =</span> <span class="ot">TRUE</span>){</span>
<span id="cb92-3"><a href="#cb92-3"></a>  FUN &lt;-<span class="st"> </span><span class="kw">match.fun</span>(FUN)</span>
<span id="cb92-4"><a href="#cb92-4"></a>  answer &lt;-<span class="st"> </span><span class="kw">Map</span>(FUN,X)</span>
<span id="cb92-5"><a href="#cb92-5"></a>  <span class="kw">vapply</span>(answer, <span class="cf">function</span>(x) x, <span class="dt">FUN.VALUE =</span> FUN.VALUE)</span>
<span id="cb92-6"><a href="#cb92-6"></a>}</span>
<span id="cb92-7"><a href="#cb92-7"></a></span>
<span id="cb92-8"><a href="#cb92-8"></a><span class="co">#example:</span></span>
<span id="cb92-9"><a href="#cb92-9"></a>a &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>),<span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">3</span>),<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">4</span>),<span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">5</span>))</span>
<span id="cb92-10"><a href="#cb92-10"></a> <span class="co"># in a vector</span></span>
<span id="cb92-11"><a href="#cb92-11"></a><span class="kw">valapply</span>(a,mean,<span class="kw">numeric</span>(<span class="dv">1</span>)) </span></code></pre></div>
<pre><code>## [1] 1.5 2.5 2.5 5.0</code></pre>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a> <span class="co"># in a matrix</span></span>
<span id="cb94-2"><a href="#cb94-2"></a><span class="kw">valapply</span>(a,<span class="cf">function</span>(x) x<span class="op">^</span><span class="dv">2</span>,<span class="kw">numeric</span>(<span class="dv">2</span>)) </span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    4    1   25
## [2,]    4    9   16   25</code></pre>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a> <span class="co"># in an array</span></span>
<span id="cb96-2"><a href="#cb96-2"></a><span class="kw">valapply</span>(a,<span class="cf">function</span>(x) x <span class="op">%*%</span><span class="st"> </span><span class="kw">t</span>(x),<span class="kw">matrix</span>(<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">2</span>))  </span></code></pre></div>
<pre><code>## , , 1
## 
##      [,1] [,2]
## [1,]    1    2
## [2,]    2    4
## 
## , , 2
## 
##      [,1] [,2]
## [1,]    4    6
## [2,]    6    9
## 
## , , 3
## 
##      [,1] [,2]
## [1,]    1    4
## [2,]    4   16
## 
## , , 4
## 
##      [,1] [,2]
## [1,]   25   25
## [2,]   25   25</code></pre>
</div>
</div>
<div id="section-9" class="section level1">
<h1>2020-12-01</h1>
<div id="question-5" class="section level2">
<h2>Question</h2>
<p>Write an Rcpp function for Exercise 9.4 (page 277, Statistical Computing with R).</p>
<p>Exercise9.4 Implement a random walk Metropolis sampler for generating the standard Laplace distribution (see Exercise 3.2). For the increment, simulate from a normal distribution. Compare the chains generated when different variances are used for the proposal distribution. Also, compute the acceptance rates of each chain.</p>
<p>Compare the corresponding generated random numbers with those by the R function you wrote before using the function “qqplot”.</p>
<p>Campare the computation time of the two functions with the function “microbenchmark”.</p>
<p>Comments your results.</p>
</div>
<div id="answer-5" class="section level2">
<h2>Answer</h2>
<p>The source R code for <em>rw.MetropolisC</em> is as follows:</p>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a>List <span class="kw">rw_MetropolisC</span>(double sigma,double x0,int N){</span>
<span id="cb98-2"><a href="#cb98-2"></a>  NumericVector <span class="kw">x</span>(N);</span>
<span id="cb98-3"><a href="#cb98-3"></a>  x[<span class="dv">0</span>]=x0;</span>
<span id="cb98-4"><a href="#cb98-4"></a>  NumericVector <span class="kw">u</span>(N);</span>
<span id="cb98-5"><a href="#cb98-5"></a>  u=<span class="kw">runif</span>(N);</span>
<span id="cb98-6"><a href="#cb98-6"></a>  double y;</span>
<span id="cb98-7"><a href="#cb98-7"></a>  int k =<span class="st"> </span><span class="dv">0</span>;</span>
<span id="cb98-8"><a href="#cb98-8"></a>  <span class="cf">for</span> (int <span class="dt">i=</span><span class="dv">1</span>;i<span class="op">&lt;</span>N;i<span class="op">++</span>) {</span>
<span id="cb98-9"><a href="#cb98-9"></a>    y =<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>,x[i<span class="dv">-1</span>],sigma);</span>
<span id="cb98-10"><a href="#cb98-10"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>])<span class="op">-</span><span class="kw">abs</span>(y))){</span>
<span id="cb98-11"><a href="#cb98-11"></a>      x[i] =<span class="st"> </span>y;</span>
<span id="cb98-12"><a href="#cb98-12"></a>      k =<span class="st"> </span>k<span class="op">+</span><span class="dv">1</span>;</span>
<span id="cb98-13"><a href="#cb98-13"></a>    }</span>
<span id="cb98-14"><a href="#cb98-14"></a>    <span class="cf">else</span> {</span>
<span id="cb98-15"><a href="#cb98-15"></a>      x[i] =<span class="st"> </span>x[i<span class="dv">-1</span>];</span>
<span id="cb98-16"><a href="#cb98-16"></a>    }</span>
<span id="cb98-17"><a href="#cb98-17"></a>  }</span>
<span id="cb98-18"><a href="#cb98-18"></a>  List <span class="kw">out</span>(<span class="dv">2</span>);</span>
<span id="cb98-19"><a href="#cb98-19"></a>  out[<span class="dv">0</span>] =<span class="st"> </span>x;</span>
<span id="cb98-20"><a href="#cb98-20"></a>  out[<span class="dv">1</span>] =<span class="st"> </span>k;</span>
<span id="cb98-21"><a href="#cb98-21"></a>  return out;</span>
<span id="cb98-22"><a href="#cb98-22"></a>}</span></code></pre></div>
<p>using Rcpp function:</p>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1"></a><span class="kw">library</span>(Rcpp) </span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;Rcpp&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1"></a><span class="kw">cppFunction</span>(<span class="st">&#39;List rw_MetropolisC(double sigma,double x0,int N){</span></span>
<span id="cb101-2"><a href="#cb101-2"></a><span class="st">  NumericVector x(N);</span></span>
<span id="cb101-3"><a href="#cb101-3"></a><span class="st">  x[0]=x0;</span></span>
<span id="cb101-4"><a href="#cb101-4"></a><span class="st">  NumericVector u(N);</span></span>
<span id="cb101-5"><a href="#cb101-5"></a><span class="st">  u=runif(N);</span></span>
<span id="cb101-6"><a href="#cb101-6"></a><span class="st">  double y;</span></span>
<span id="cb101-7"><a href="#cb101-7"></a><span class="st">  int k = 0;</span></span>
<span id="cb101-8"><a href="#cb101-8"></a><span class="st">  for (int i=1;i&lt;N;i++) {</span></span>
<span id="cb101-9"><a href="#cb101-9"></a><span class="st">    y = rnorm(1,x[i-1],sigma)[0];</span></span>
<span id="cb101-10"><a href="#cb101-10"></a><span class="st">    if (u[i] &lt;= exp(abs(x[i-1])-abs(y))){</span></span>
<span id="cb101-11"><a href="#cb101-11"></a><span class="st">      x[i] = y;</span></span>
<span id="cb101-12"><a href="#cb101-12"></a><span class="st">      k = k+1;</span></span>
<span id="cb101-13"><a href="#cb101-13"></a><span class="st">    }</span></span>
<span id="cb101-14"><a href="#cb101-14"></a><span class="st">    else {</span></span>
<span id="cb101-15"><a href="#cb101-15"></a><span class="st">      x[i] = x[i-1];</span></span>
<span id="cb101-16"><a href="#cb101-16"></a><span class="st">    }</span></span>
<span id="cb101-17"><a href="#cb101-17"></a><span class="st">  }</span></span>
<span id="cb101-18"><a href="#cb101-18"></a><span class="st">  List out(2);</span></span>
<span id="cb101-19"><a href="#cb101-19"></a><span class="st">  out[0] = x;</span></span>
<span id="cb101-20"><a href="#cb101-20"></a><span class="st">  out[1] = k;</span></span>
<span id="cb101-21"><a href="#cb101-21"></a><span class="st">  return out;</span></span>
<span id="cb101-22"><a href="#cb101-22"></a><span class="st">  }&#39;</span></span>
<span id="cb101-23"><a href="#cb101-23"></a>)</span>
<span id="cb101-24"><a href="#cb101-24"></a></span>
<span id="cb101-25"><a href="#cb101-25"></a></span>
<span id="cb101-26"><a href="#cb101-26"></a>N =<span class="st"> </span><span class="dv">2000</span></span>
<span id="cb101-27"><a href="#cb101-27"></a>sigma =<span class="st"> </span><span class="kw">c</span>(<span class="fl">0.05</span>, <span class="fl">0.5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb101-28"><a href="#cb101-28"></a>x0 =<span class="st"> </span><span class="dv">20</span></span>
<span id="cb101-29"><a href="#cb101-29"></a>ch1.C =<span class="st"> </span><span class="kw">rw_MetropolisC</span>(sigma[<span class="dv">1</span>],x0,N)</span>
<span id="cb101-30"><a href="#cb101-30"></a>ch2.C =<span class="st"> </span><span class="kw">rw_MetropolisC</span>(sigma[<span class="dv">2</span>],x0,N)</span>
<span id="cb101-31"><a href="#cb101-31"></a>ch3.C =<span class="st"> </span><span class="kw">rw_MetropolisC</span>(sigma[<span class="dv">3</span>],x0,N)</span>
<span id="cb101-32"><a href="#cb101-32"></a>ch4.C =<span class="st"> </span><span class="kw">rw_MetropolisC</span>(sigma[<span class="dv">4</span>],x0,N)</span>
<span id="cb101-33"><a href="#cb101-33"></a></span>
<span id="cb101-34"><a href="#cb101-34"></a>accep.C =<span class="st"> </span><span class="kw">cbind</span>(ch1.C[[<span class="dv">2</span>]], ch2.C[[<span class="dv">2</span>]], ch3.C[[<span class="dv">2</span>]], ch4.C[[<span class="dv">2</span>]])<span class="op">/</span>N</span>
<span id="cb101-35"><a href="#cb101-35"></a><span class="kw">rownames</span>(accep.C) =<span class="st"> &#39;Accept rates&#39;</span></span>
<span id="cb101-36"><a href="#cb101-36"></a><span class="kw">colnames</span>(accep.C) =<span class="st"> </span><span class="kw">paste</span>(<span class="st">&#39;sigma=&#39;</span>,sigma)</span>
<span id="cb101-37"><a href="#cb101-37"></a>knitr<span class="op">::</span><span class="kw">kable</span>(accep.C)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left"></th>
<th align="right">sigma= 0.05</th>
<th align="right">sigma= 0.5</th>
<th align="right">sigma= 2</th>
<th align="right">sigma= 16</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Accept rates</td>
<td align="right">0.974</td>
<td align="right">0.831</td>
<td align="right">0.5265</td>
<td align="right">0.1015</td>
</tr>
</tbody>
</table>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1"></a><span class="kw">plot</span>(ch1.C[[<span class="dv">1</span>]],<span class="dt">type =</span><span class="st">&#39;l&#39;</span>, <span class="dt">main =</span> <span class="st">&#39;sigma = 0.05&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1"></a><span class="kw">plot</span>(ch2.C[[<span class="dv">1</span>]],<span class="dt">type =</span><span class="st">&#39;l&#39;</span>, <span class="dt">main =</span> <span class="st">&#39;sigma = 0.5&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb104"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1"></a><span class="kw">plot</span>(ch3.C[[<span class="dv">1</span>]],<span class="dt">type =</span><span class="st">&#39;l&#39;</span>, <span class="dt">main =</span> <span class="st">&#39;sigma = 2&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1"></a><span class="kw">plot</span>(ch4.C[[<span class="dv">1</span>]],<span class="dt">type =</span><span class="st">&#39;l&#39;</span>, <span class="dt">main =</span> <span class="st">&#39;sigma = 16&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAAqFBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmZmZmkLZmtrZmtttmtv+QOgCQZgCQZjqQkGaQkLaQttuQtv+Q2/+2ZgC2Zjq2kGa229u22/+2/7a2///bkDrbkGbbtmbbtpDb27bb/9vb////tmb/25D/27b//7b//9v///8PuoXWAAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJt0lEQVR4nO2dC3vaNhSGlTZp6LKuXbLuUrJ1W7y2C70MkuD//88mW5ItXz8ZH4Mw3/s8LcTIx9aLbjZCqJT0og59ArFDQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFAQ4qaHurLtbjwyQuypcrpc4/jQ/oc/yCtv8oG0U/0ZzdjT8xj6OvYl/fKitoo9S79GFxdi0a/xCCPuuacPb6U1GCsjJwfpeoZ/dPN+ry65U6e5d+XuhNWeJcwCtXKh4WSlXKyUo/XRhBiUh9rXMAQSuTxWf3VpD+P8vxlRFkuLIpsmLh+2gRdP7RaNb7vtCmXwtL2r+grJSs0y9KXVtB2sHlepsoK+g6e01XlpVN8WKdabH1piHo85u1LYfupUyrIPsXpDNy/tE8NVlL8jxpN7kgvcH8X1j59kGXp8vugJ6gayNekv0LMjXq+a9rmzXXlbk2yJSx1Ara/mHKRZCgotYKcoA26PGtqSR/m9wYHR2CMpvnf367cYIaVSz1BWUPiXAdO0g3//j+Ku+bcQkyxegpRJCpmPMQpNn+rjPS1gZVBekGfJn2NdJpOVi4zeNId/b7F6Tz/OM6q2eu8FR7sUYJulg/3oa0QSbO18XRN9L2iiArA23joGYbFNhIZ4VHuVG1HIeoYtk1pXpVHUn/8Km7Fzv/a9XXsBSCth90BXxz9APFLqa5UhhNBIJ0zXiTF5ieanQ4IhC0aXZMERGBoPTx54W9vI+QGARFDQUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggDDBLm5BMLzAGNmkKCVm1qyEZ5jEjFDBG1vCy2rKCcaTMEQQU83S/d0czKVTLgEqaNhCkG6DbJFqLMNOppOcRpBqfuqQGcLdOqC9h1uOvYsqFa1j0DTRIKyL+rkzdCqoxc7cUGrszvdDGVTCSmoDdPNb291E01BbbiBYnKxpqA2ioFicklBrTgt+RdPesKdrKBiKL29paAxx6UgEI6CQDgKAuEoCIWL3xAFASgIQEEACgJQEOCwdxQpCIWbnaBiYSPD7p8KzlfQ0ts24mNTCgo77uwESR93doLYBoGErGIgIQWNT5gDp+CduCA8Be+0BYVMoBoe9TCM6MW6G6CAKXhzFdT9QZfPCZegLPMB6z8FT8GboSCd52VfOkPoFLw5ChI9LgXVo8z9hhlH0iAhBYGEYVfzAaOluQoKBI+W5iootIrB0dKpC4KjpfkK4h3FsQkHhaMgEG6Ggkzz+7AY+V3U2Qp6ujHXn+5x5HHnJyhxXp5uRpWhuQoS+z7zXAWJfZ95voLKEkRBbQmT4hIimUEVCzj8UEEPi2XtybAzmuyG2U6RJhDkbsOvRi7KIS9ol1BTCLKfKo/9aYsJBO0QaxJBMlBQWDhV/XNMwOgEiXbzMQpSOElwrOE4QWJVTURQJQYFzU1Qf5rIBO02TGyGU7XHtmP1by1eDTPUf6DxgsLmBwWHO6wgVQ+pBEqQHUjvsQQp/0m3BCcIZGhyQfZW4gSCvB5/kKAigi+ox6O/Z1OQ9/rObVBydheVIJsRm7n2bGUv5Ql8AS2C/D13b6T1heokgkwWVSWz3ltaEeRtdhnpFKSKrDtB7o5CuyBVnEg9UkCOch4Wz4Gg4HnSxdtvTr7MR0OQaghymbUBuwWV5v19+gSl4wRl+e8VFD5P2r2VQJAqMuU9VG4ttQoqdPiCivKpSv2lNydIjRIEGDDL1b1byntanLl7UopweXVVsrTUIUippqAiuhe2KWjoOnRlQrzSb/et/XIU1SOolgXT3fjKbNLSpx+7sin1grcK8s7Iq4jpKEEJHCGOLEFp8Sam7l31Bdn9WwWlXh5rguxeVUFF5bIBJASFfGIYPk/adRedgurbK4LSbkF+idhFUCPfCE+Q5DzphqBqP5w6Md5j6rLaJqgoNO58i1pX/OEfwwlyaVP36ghBQVPtQ8O1CHLbq11ymKC0FFQ7XNmfYUGV7O7QBo0eJHrhai1s8XddUJmi7Kaagsq/64LScEG1XQcKkr+aL5rTsk12D1VB7nmYoI6jqrRivpbSP4PaiQbnSIqmINd7eGkax6zkvUtQz9nWU7YJat8FM5Wg2rZ+QdUQZddT+dsL33vU6QRln8qP/bmDLkGVNEEnF58gM2vBLPa7MxMLCj8LlHy4IDcOkpkfdFhBLQcd+nozobuOkPngcIaC7HXEyHmubYIaaY5UkHaju46zu2En0h5uaHbaIhWCxpzIzq8PTzgonISgxpPddt/x9eEJB4WjoHoU79aUUNR5CaqHoyAQ7vCCgsOLJRwUTlLQNFCQVHgKkko4KNzEuRNgIkFcoqsfLtHVz0kvsBTCKS/RFQRLEOKkl+gKgkt0CR2XgkA4CgLhKKgepXbDLH4mGgfBKQ6nLSh8ia74mexiNWyJrviZqg2CS3QdDRMJkg0amO4gyXZMLht0poK8a9aRQSlIJh0FxZhsx+QZFASgoNFQkFDQkxU0JygIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBBAXtCm9ztV5tPZSz9d/w59PHx3Lx2ygbigjT6zTffZPby8q6UDO/TwdJN/0CsZsom0IHO7Men8ANZNbizSoR262dgZAoIhW5AWZBa46P7i6+qylg7t0MlGXRs1ciHbEBeUl/fur04n3+v24tpLh3bow+wlGrKBtCBT9TsbALNcY3JdpgM79B8scyAbssGeBdlEz+7lBMmGbLDvKmYSLZaCVUw0ZIN9N9Im0cs7kRbVFyQUssGeu3lz7jpjIn1yLkg2ZIN9DxTz09YtqsiozvZikiEbyF9qrPqH+Ynuk5eVdGCHHmwVkwzZgBerAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBAgPkGNWQdS0xB2g4IAFASIUtDTzW83ZkZLNo/lfSZoZWayZtPGQn6uUo5IBWknK/0v+2nTjbJ/ZL+qk00e61pHdhoiFXRtpmXms+sSuyGfL7V59u9Pe61xkQpa5oszmxlkxcTe3FeiZOYehhK1oFUhyK7MtsTLzEkTtaBaCcrY3v4iM703lKgF2QnPdkPO6uI/uHyRKFELyjuvohczrfVSagp9IHELqo6DtJjslyplfnQ5lPgERQYFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFAT4Hw+x/Xo0l5IKAAAAAElFTkSuQmCC" /><!-- --></p>
<p>The source R code for <em>rwM.gen.chain</em> is as follows:</p>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1"></a>rwM.gen.chain &lt;-<span class="st"> </span><span class="cf">function</span>(sigma,x0,N) {</span>
<span id="cb106-2"><a href="#cb106-2"></a>  x &lt;-<span class="st"> </span><span class="kw">numeric</span>(N)</span>
<span id="cb106-3"><a href="#cb106-3"></a>  x[<span class="dv">1</span>] &lt;-<span class="st"> </span>x0</span>
<span id="cb106-4"><a href="#cb106-4"></a>  u &lt;-<span class="st"> </span><span class="kw">runif</span>(N)</span>
<span id="cb106-5"><a href="#cb106-5"></a>  k &lt;-<span class="st"> </span><span class="dv">0</span></span>
<span id="cb106-6"><a href="#cb106-6"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="op">:</span>N) {</span>
<span id="cb106-7"><a href="#cb106-7"></a>    y &lt;-<span class="st"> </span><span class="kw">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb106-8"><a href="#cb106-8"></a>    r &lt;-<span class="st"> </span><span class="kw">exp</span>(<span class="kw">abs</span>(x[i<span class="dv">-1</span>])<span class="op">-</span><span class="kw">abs</span>(y))</span>
<span id="cb106-9"><a href="#cb106-9"></a>    <span class="cf">if</span> (u[i] <span class="op">&lt;=</span><span class="st"> </span>r){</span>
<span id="cb106-10"><a href="#cb106-10"></a>      x[i] &lt;-<span class="st"> </span>y </span>
<span id="cb106-11"><a href="#cb106-11"></a>      k &lt;-<span class="st"> </span>k <span class="op">+</span><span class="st"> </span><span class="dv">1</span></span>
<span id="cb106-12"><a href="#cb106-12"></a>    } <span class="cf">else</span> </span>
<span id="cb106-13"><a href="#cb106-13"></a>      x[i] &lt;-<span class="st"> </span>x[i<span class="dv">-1</span>]</span>
<span id="cb106-14"><a href="#cb106-14"></a>  }</span>
<span id="cb106-15"><a href="#cb106-15"></a>  <span class="kw">return</span>(<span class="kw">list</span>(<span class="dt">x=</span>x,<span class="dt">accept=</span>k<span class="op">/</span>N )) </span>
<span id="cb106-16"><a href="#cb106-16"></a>  <span class="co"># accept:the acceptance rates of chain</span></span>
<span id="cb106-17"><a href="#cb106-17"></a>}</span></code></pre></div>
<p>using R function:</p>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1"></a>ch1 &lt;-<span class="st"> </span><span class="kw">rwM.gen.chain</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb107-2"><a href="#cb107-2"></a>ch2 &lt;-<span class="st"> </span><span class="kw">rwM.gen.chain</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb107-3"><a href="#cb107-3"></a>ch3 &lt;-<span class="st"> </span><span class="kw">rwM.gen.chain</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb107-4"><a href="#cb107-4"></a>ch4 &lt;-<span class="st"> </span><span class="kw">rwM.gen.chain</span>(sigma[<span class="dv">4</span>], x0, N)</span>
<span id="cb107-5"><a href="#cb107-5"></a></span>
<span id="cb107-6"><a href="#cb107-6"></a>accep &lt;-<span class="st"> </span><span class="kw">c</span>(ch1<span class="op">$</span>accept, ch2<span class="op">$</span>accept, ch3<span class="op">$</span>accept, ch4<span class="op">$</span>accept)</span>
<span id="cb107-7"><a href="#cb107-7"></a><span class="kw">names</span>(accep) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;sigma=0.05&#39;</span>,<span class="st">&#39;sigma=0.5&#39;</span>,<span class="st">&#39;sigma=2&#39;</span>,<span class="st">&#39;sigma=16&#39;</span>)</span>
<span id="cb107-8"><a href="#cb107-8"></a><span class="kw">print</span>(accep)</span></code></pre></div>
<pre><code>## sigma=0.05  sigma=0.5    sigma=2   sigma=16 
##     0.9795     0.8180     0.5300     0.1020</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1"></a>index &lt;-<span class="st"> </span><span class="dv">1</span><span class="op">:</span>N</span>
<span id="cb109-2"><a href="#cb109-2"></a></span>
<span id="cb109-3"><a href="#cb109-3"></a><span class="kw">plot</span>(index,ch1<span class="op">$</span>x,<span class="dt">type =</span><span class="st">&#39;l&#39;</span>, <span class="dt">main =</span> <span class="st">&#39;sigma = 0.05&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1"></a><span class="kw">plot</span>(index,ch2<span class="op">$</span>x,<span class="dt">type =</span><span class="st">&#39;l&#39;</span>, <span class="dt">main =</span> <span class="st">&#39;sigma = 0.5&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1"></a><span class="kw">plot</span>(index,ch3<span class="op">$</span>x,<span class="dt">type =</span><span class="st">&#39;l&#39;</span>, <span class="dt">main =</span> <span class="st">&#39;sigma = 2&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1"></a><span class="kw">plot</span>(index,ch4<span class="op">$</span>x,<span class="dt">type =</span><span class="st">&#39;l&#39;</span>, <span class="dt">main =</span> <span class="st">&#39;sigma = 16&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>Compare the corresponding generated random numbers with those by the R function you wrote before :</p>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1"></a>x &lt;-<span class="st"> </span><span class="kw">rbind</span>(ch1<span class="op">$</span>x,ch2<span class="op">$</span>x,ch3<span class="op">$</span>x,ch4<span class="op">$</span>x)</span>
<span id="cb113-2"><a href="#cb113-2"></a>y &lt;-<span class="st"> </span><span class="kw">rbind</span>(ch1.C[[<span class="dv">1</span>]],ch2.C[[<span class="dv">1</span>]],ch3.C[[<span class="dv">1</span>]],ch4.C[[<span class="dv">1</span>]])</span>
<span id="cb113-3"><a href="#cb113-3"></a></span>
<span id="cb113-4"><a href="#cb113-4"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="op">:</span><span class="dv">4</span>) {</span>
<span id="cb113-5"><a href="#cb113-5"></a>  <span class="kw">qqplot</span>(x[i,],y[i,],<span class="dt">xlab =</span> <span class="st">&#39;using R&#39;</span>,</span>
<span id="cb113-6"><a href="#cb113-6"></a>         <span class="dt">ylab =</span> <span class="st">&#39;using C&#39;</span>,<span class="dt">main=</span><span class="kw">paste</span>(<span class="st">&#39;sigma=&#39;</span>,sigma[i]))</span>
<span id="cb113-7"><a href="#cb113-7"></a>  <span class="kw">qqline</span>(y[i,])</span>
<span id="cb113-8"><a href="#cb113-8"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAASAAAAEgCAMAAAAjXV6yAAAApVBMVEUAAAAAADoAAGYAOjoAOmYAOpAAZpAAZrY6AAA6ADo6AGY6OgA6Ojo6OmY6OpA6ZpA6ZrY6kLY6kNtmAABmADpmOgBmOjpmkLZmtrZmtttmtv+QOgCQZgCQZjqQkGaQkLaQttuQtv+Q2/+2ZgC2Zjq2kGa2tma229u22/+2/7a2///bkDrbkGbbtmbbtpDb27bb////tmb/25D/27b//7b//9v////vYXj5AAAACXBIWXMAAA7DAAAOwwHHb6hkAAAJ/klEQVR4nO2dCXubNgCGlS6ZvWZns3Wbs6Mr3daVHiaN+f8/bRICAjbwoQsk+3ufp4nt6IC3OrEEoiSTiLUPIHYoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgwFqCDvfiZu8Q/Y0QVz/vh97nomLjfIiaNAXJ2D0J3ffZeQhyIxdXr8r3QuxO3z/eiRc+s1pY0PtbWRW+e9uWIFU1rl9n4tk7eWKbj7fi6tfy/VZ+pAJ//EmWhG/ky4etLhXiqvpcRd40P4/fy7C70ewtWFZQ3T48e1cL0lXj6lYL0tzWIcqilXIsqC4lWVNLu+9lrK+l1re+DnlRQaqU7MsPQp6OFiTPZrM/ZKIW9EL9TfyqPFYhvtwrNy9OBFUfKiHK49H7rBfSnUUFyRO5/le/1IL0KUo3lSD5gf5Zn3BZfvr7dqi5nRB0+H17/bb8uHXqI7ssKkjXqC9Ud1wJarqypg3SZaw54cPvY/3RVAnS5N6K0LJt0OefdPn/SwvSOkYEKZvXf35SH5hUMU2RqCCp6A/VCNeFZ7IE6bN+HBI01Uhr0hUkOfym2oqBNqgvqKiGNYONdNsFPnXzzfuHl9ujwuTIooLkOf+wV/WsKTz9XuykBN3sP98PjonzarykDOp0eu/lmPHDNtGR9Ju2IAyNg07boLFJw9PUoptOFbIubb46saWr2AfVAn3TH0l/+3a8F7t+lQ9WlsObrZ6ctulsm8nq55dS+fe+/MQxF8v8/Yd7Z11BsvX5viowvloM/6wrqOj3TjGychX7/HJbT+9jJYo2KGYoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEMBPULCjwtbYkAYwE5c0S5MLvWuSYMRF0uG+15PGuNvCMiaDHu3aJdnExlcxzCRLJEEKQbIPqIjTaBsXfKdZuwggqm/0Coy1Q9IJE59/sCJ7zjxldu8Tigsyr9kq0RxlIkNqtUzVD+UgvFrkgEVhQfvVaNkNqPWGSgrrlPIgg3c0f7tXK7QQFieCCmoFidrNPUFB/DBSwBEmyTXqCxAKC2opV7T5xT25JjgfRwXoxXckO94kJOplkcKDY43QSRkEdhqaoFKQZncNT0OCVl85fZyfj+aj8JmfNkJ3eRPGyBUE9ly1oWM/RkV2woFl+LljQLD0UNOVGB5udnq8DC5KcxQFANXW42Qm6H1PA5CwOYJaeyxU0Uw8F4YCzU3Q6ntDJmedPQdPZz/VDQTDk7CRdjid4cqa5BxR0uNf3lrFbGDW3cw2MwUGYCnq80+sRmt+2nK2grPHyeOe0uG5VQSal2FCQt8V15yrI2+K6NQUZtYPGgp5KUPKC5gWenar+lbW3gMpSrWJmHampoIft7uiFHREImhl6drL173pZZu64Qnw9QYYjMfORtN5l4HqztdUEmY5UL26qQUEgX9OpzqUKmh/Be8BVkpudLQVN52p+LeEyBZlEMQ7YPrZBuDyXYhVBNhejLEqQHioWYjdxxSOTI6VqwDTmcFVBRnGMA+pLitXljtErHnl1l/XNxFWjNQTZFCCrKqZLRfHs3dgVj+qqUVHduXd0Q53JQfrByo9VCdKFIh9fRl851PbGHC4vSCwl6KkNairbCRGWIGHpx6qbr/ox9XSc0UtmbRvUuURrma8z4hjD6N4DVsTSi53YMf6+6awHigN6jPO1EORy2wn7A3XIykGPlaDxpidEvtYZ+PFjNQ7ycTuO0IJ8+XEYKE7Qma6ts1/Mmx6XqcYUo9vEzPO1wJOaOjHzgMWMWTy0GEyQTzlVesYB2/ozWUiQxVCCfPs5t3GQZzvluQny7+e8BAXwY7G6Y14b5C1fo0S96zmvEhRAz3kK8puoeUA118hdn54YQFCA4lPaTVZv9g/bTWcpVdB8DZIM4cdyLqaGgbGtUQxTgCwFqSsesa1RDOPHqopt1CpyfYOp8PnOTzEaQXIgdPV6zpzeS77zUwzi54y6eQpCKcYiKNapRjSCahxv83v+gmIbKAbqxBwERTZQjE9QXAPFUH7sBdkNFENckOil6zfZ0qUXi2k2H8p7eSbjoIB+zkGQCOknfUEirJ+kBYkjPCQ5kIn3gOGTOxYT0k96gkbsBFuRlZagUTvhVqylJGhCT7jVNAkImvISWk/sgma4CasnVkHzxIR2M+NAbQI6JNc987XFTB6oU0Db5GaXmgXtDB6oa0Cr5CK1c3qgHgLaJBetnmCC1HfTD1shqi1RMLkIvTwdm/eAisrPV68nVp13kovWjT467wHLereC/tYDbaiL1UtLIEG7Zisd2JIZr5iGQFVMlp58RgmK3U4ZStDj3bN3nY2rY8lFb6cM180X+qxHvxpSyaXgZ9VxUAJ6FhfUVZKEnzVLUAp6ohDkN2HfBBoHPdWeiXFQCn4ClaCZWzIT8BOqiq23JdM34cZBYEtmMgQS5J5mdH8EUBCAggAUBKAgAAUBKAhAQQAKAiQzN1gLCgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBPAs6OG5+mZRfwVrtn26ilmvrjF79InOU91ebHRtqQN+BakVVvJXtdDTKqZ+aaS2jplJO47PHxzEq6Ci/s7e/O4NRefbfrNbG9Qx9e2w3R4SO4hPQYV4odXkpjcnaGOWps+bbmLqRYGjSwPt8dwG6dPMvpbtiOENzltBxreO7wpyeXDTMCEE6SdqZ2aGGkHmt46vYurmJ09D0MlLk5jmtaToNNIpCTLsUpqY5k8KrmNmsrX+78c02qAKw76+jmnxcIZuns89PPqiTwhBuuzYVTGLoUwno8i7+bJtD1Q3b9dIW3TUdcewCdLLB6pimel0oY1pcQMsHVNNb+KfapwhFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBAAoCUBCAggAUBKAgAAUBKAhAQQAKAlAQgIIAFASgIEC8gkZvh3q412uFjdfJWBGvoFHqmxgFWI84RLqCXJ94OpN4BFVVSv1Q92OWpUO9fLz75U4vpMmEuPpDL29pzJgv1rMhPkHVGjNZf7Qg6SSX/9Ta4EL0BF1sCXpaD7zTKxalMb0wL+sJCrDkd4j4BDW7NrSgrrSiEWSx48Wa+ARpAbueoLwvaKOK1SIVLEpBClmbJkqQclNc3DioaW/qN7uuoHqjQa8NykIs2TwlHkGH+5u9rF27qpwU/RI01IvpHSHBiUdQtZD3FylDbTuUKnqCqo0G/+jWu+nf80UqWUSCII4P6rYjDUFVG2SxjcMDaQjSu32XGfgckYig9aAgAAUBKAhAQQAKAlAQgIIAFASgIAAFASgIQEEACgJQEICCABQEoCAABQEoCEBBgP8B8cuAreRgtKgAAAAASUVORK5CYII=" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1"></a><span class="kw">library</span>(microbenchmark)</span></code></pre></div>
<pre><code>## Warning: 程辑包&#39;microbenchmark&#39;是用R版本4.0.3 来建造的</code></pre>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1"></a><span class="kw">microbenchmark</span>(<span class="dt">ch1=</span><span class="kw">rwM.gen.chain</span>(sigma[<span class="dv">1</span>], x0, N),</span>
<span id="cb116-2"><a href="#cb116-2"></a>               <span class="dt">ch1.C=</span><span class="kw">rw_MetropolisC</span>(sigma[<span class="dv">1</span>],x0,N))</span></code></pre></div>
<pre><code>## Unit: microseconds
##   expr      min        lq     mean    median       uq       max neval
##    ch1 5736.001 6191.3510 7814.799 6959.3015 8605.901 16834.000   100
##  ch1.C  379.002  400.0015  454.614  423.0505  472.652   775.601   100</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1"></a><span class="kw">microbenchmark</span>(<span class="dt">ch2=</span><span class="kw">rwM.gen.chain</span>(sigma[<span class="dv">2</span>], x0, N),</span>
<span id="cb118-2"><a href="#cb118-2"></a>               <span class="dt">ch2.C=</span><span class="kw">rw_MetropolisC</span>(sigma[<span class="dv">2</span>],x0,N))</span></code></pre></div>
<pre><code>## Unit: microseconds
##   expr      min        lq     mean   median        uq       max neval
##    ch2 5765.801 6374.4005 7916.426 6934.451 8855.7020 16184.101   100
##  ch2.C  379.101  406.8015  468.905  438.301  493.5015   854.702   100</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1"></a><span class="kw">microbenchmark</span>(<span class="dt">ch3=</span><span class="kw">rwM.gen.chain</span>(sigma[<span class="dv">3</span>], x0, N),</span>
<span id="cb120-2"><a href="#cb120-2"></a>               <span class="dt">ch3.C=</span><span class="kw">rw_MetropolisC</span>(sigma[<span class="dv">3</span>],x0,N))</span></code></pre></div>
<pre><code>## Unit: microseconds
##   expr      min       lq     mean   median       uq       max neval
##    ch3 5645.901 6216.251 7294.538 6679.001 7497.801 11849.901   100
##  ch3.C  361.800  377.551  440.435  416.101  464.801   802.002   100</code></pre>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1"></a><span class="kw">microbenchmark</span>(<span class="dt">ch4=</span><span class="kw">rwM.gen.chain</span>(sigma[<span class="dv">4</span>], x0, N),</span>
<span id="cb122-2"><a href="#cb122-2"></a>               <span class="dt">ch4.C=</span><span class="kw">rw_MetropolisC</span>(sigma[<span class="dv">4</span>],x0,N))</span></code></pre></div>
<pre><code>## Unit: microseconds
##   expr      min        lq     mean   median        uq       max neval
##    ch4 5520.701 6039.4010 7226.233 6414.150 7053.8010 13397.801   100
##  ch4.C  334.801  347.4515  389.332  361.651  407.2505   642.401   100</code></pre>
<p>Obviously, functions in C code take less time to run.</p>
<p>Using Rcpp functions to generate random numbers is faster.</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
